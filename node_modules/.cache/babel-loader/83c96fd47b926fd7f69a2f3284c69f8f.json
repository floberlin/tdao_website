{"ast":null,"code":"import UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport litRender from \"@ui5/webcomponents-base/dist/renderer/LitRenderer.js\";\nimport ResizeHandler from \"@ui5/webcomponents-base/dist/delegate/ResizeHandler.js\";\nimport ValueState from \"@ui5/webcomponents-base/dist/types/ValueState.js\";\nimport { isShow, isDown, isUp, isBackSpace, isSpace, isLeft, isRight, isEscape, isEnter } from \"@ui5/webcomponents-base/dist/Keys.js\";\nimport Integer from \"@ui5/webcomponents-base/dist/types/Integer.js\";\nimport \"@ui5/webcomponents-icons/dist/slim-arrow-down.js\";\nimport { isIE, isPhone } from \"@ui5/webcomponents-base/dist/Device.js\";\nimport { getI18nBundle } from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport \"@ui5/webcomponents-icons/dist/decline.js\";\nimport \"@ui5/webcomponents-icons/dist/multiselect-all.js\";\nimport \"@ui5/webcomponents-icons/dist/not-editable.js\";\nimport MultiComboBoxItem from \"./MultiComboBoxItem.js\";\nimport Tokenizer from \"./Tokenizer.js\";\nimport Token from \"./Token.js\";\nimport Icon from \"./Icon.js\";\nimport Popover from \"./Popover.js\";\nimport ResponsivePopover from \"./ResponsivePopover.js\";\nimport List from \"./List.js\";\nimport StandardListItem from \"./StandardListItem.js\";\nimport ToggleButton from \"./ToggleButton.js\";\nimport * as Filters from \"./ComboBoxFilters.js\";\nimport Button from \"./Button.js\";\nimport { VALUE_STATE_SUCCESS, VALUE_STATE_ERROR, VALUE_STATE_WARNING, VALUE_STATE_INFORMATION, INPUT_SUGGESTIONS_TITLE, SELECT_OPTIONS, MULTICOMBOBOX_DIALOG_OK_BUTTON, VALUE_STATE_ERROR_ALREADY_SELECTED } from \"./generated/i18n/i18n-defaults.js\"; // Templates\n\nimport MultiComboBoxTemplate from \"./generated/templates/MultiComboBoxTemplate.lit.js\";\nimport MultiComboBoxPopoverTemplate from \"./generated/templates/MultiComboBoxPopoverTemplate.lit.js\"; // Styles\n\nimport styles from \"./generated/themes/MultiComboBox.css.js\";\nimport ResponsivePopoverCommonCss from \"./generated/themes/ResponsivePopoverCommon.css.js\";\nimport ValueStateMessageCss from \"./generated/themes/ValueStateMessage.css.js\";\nimport SuggestionsCss from \"./generated/themes/Suggestions.css.js\";\n/**\n * @public\n */\n\nconst metadata = {\n  tag: \"ui5-multi-combobox\",\n  languageAware: true,\n  managedSlots: true,\n  slots:\n  /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */\n  {\n    /**\n     * Defines the component items.\n     *\n     * @type {sap.ui.webcomponents.main.IMultiComboBoxItem[]}\n     * @slot items\n     * @public\n     */\n    \"default\": {\n      propertyName: \"items\",\n      type: HTMLElement,\n      invalidateOnChildChange: true\n    },\n\n    /**\n    * Defines the icon to be displayed in the component.\n    *\n    * @type {sap.ui.webcomponents.main.IIcon}\n    * @slot\n    * @public\n    * @since 1.0.0-rc.9\n    */\n    icon: {\n      type: HTMLElement\n    },\n\n    /**\n     * Defines the value state message that will be displayed as pop up under the component.\n     * <br><br>\n     *\n     * <b>Note:</b> If not specified, a default text (in the respective language) will be displayed.\n     * <br>\n     * <b>Note:</b> The <code>valueStateMessage</code> would be displayed,\n     * when the component is in <code>Information</code>, <code>Warning</code> or <code>Error</code> value state.\n     * @type {HTMLElement[]}\n     * @since 1.0.0-rc.9\n     * @slot\n     * @public\n     */\n    valueStateMessage: {\n      type: HTMLElement\n    }\n  },\n  properties:\n  /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */\n  {\n    /**\n     * Defines the value of the component.\n     * <br><br>\n     * <b>Note:</b> The property is updated upon typing.\n     *\n     * @type {string}\n     * @defaultvalue \"\"\n     * @public\n     */\n    value: {\n      type: String,\n      defaultValue: \"\"\n    },\n\n    /**\n     * Defines a short hint intended to aid the user with data entry when the\n     * component has no value.\n     * @type {string}\n     * @defaultvalue \"\"\n     * @public\n     */\n    placeholder: {\n      type: String,\n      defaultValue: \"\"\n    },\n\n    /**\n     * Defines if the user input will be prevented, if no matching item has been found\n     *\n     * @type {boolean}\n     * @defaultvalue false\n     * @public\n     */\n    allowCustomValues: {\n      type: Boolean\n    },\n\n    /**\n     * Defines whether the component is in disabled state.\n     * <br><br>\n     * <b>Note:</b> A disabled component is completely noninteractive.\n     *\n     * @type {boolean}\n     * @defaultvalue false\n     * @public\n     */\n    disabled: {\n      type: Boolean\n    },\n\n    /**\n     * Defines the value state of the component.\n     * <br><br>\n     * Available options are:\n     * <ul>\n     * <li><code>None</code></li>\n     * <li><code>Error</code></li>\n     * <li><code>Warning</code></li>\n     * <li><code>Success</code></li>\n     * <li><code>Information</code></li>\n     * </ul>\n     *\n     * @type {ValueState}\n     * @defaultvalue \"None\"\n     * @public\n     */\n    valueState: {\n      type: ValueState,\n      defaultValue: ValueState.None\n    },\n\n    /**\n     * Defines whether the component is read-only.\n     * <br><br>\n     * <b>Note:</b> A read-only component is not editable,\n     * but still provides visual feedback upon user interaction.\n     *\n     * @type {boolean}\n     * @defaultvalue false\n     * @public\n     */\n    readonly: {\n      type: Boolean\n    },\n\n    /**\n     * Defines whether the component is required.\n     *\n     * @type {boolean}\n     * @defaultvalue false\n     * @public\n     * @since 1.0.0-rc.5\n     */\n    required: {\n      type: Boolean\n    },\n\n    /**\n     * Defines the filter type of the component.\n     * Available options are: <code>StartsWithPerTerm</code>, <code>StartsWith</code>, <code>Contains</code> and <code>None</code>.\n     *\n     * @type {string}\n     * @defaultvalue \"StartsWithPerTerm\"\n     * @public\n     */\n    filter: {\n      type: String,\n      defaultValue: \"StartsWithPerTerm\"\n    },\n\n    /**\n     * Indicates whether the dropdown is open. True if the dropdown is open, false otherwise.\n     *\n     * @type {boolean}\n     * @defaultvalue false\n     * @readonly\n     * @since 1.0.0-rc.5\n     * @public\n     */\n    open: {\n      type: Boolean\n    },\n    _filteredItems: {\n      type: Object\n    },\n    filterSelected: {\n      type: Boolean\n    },\n    focused: {\n      type: Boolean\n    },\n    _tokenizerFocused: {\n      type: Boolean\n    },\n    _iconPressed: {\n      type: Boolean,\n      noAttribute: true\n    },\n    _inputWidth: {\n      type: Integer,\n      noAttribute: true\n    },\n    _listWidth: {\n      type: Integer,\n      defaultValue: 0,\n      noAttribute: true\n    },\n    _performingSelectionTwice: {\n      type: Boolean\n    }\n  },\n  events:\n  /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */\n  {\n    /**\n     * Fired when the input operation has finished by pressing Enter or on focusout.\n     *\n     * @event\n     * @public\n     */\n    change: {},\n\n    /**\n     * Fired when the value of the component changes at each keystroke.\n     *\n     * @event\n     * @public\n     */\n    input: {},\n\n    /**\n     * Fired when the dropdown is opened or closed.\n     *\n     * @event sap.ui.webcomponents.main.MultiComboBox#open-change\n     * @since 1.0.0-rc.5\n     * @public\n     */\n    \"open-change\": {},\n\n    /**\n     * Fired when selection is changed by user interaction\n     * in <code>SingleSelect</code> and <code>MultiSelect</code> modes.\n     *\n     * @event sap.ui.webcomponents.main.MultiComboBox#selection-change\n     * @param {Array} items an array of the selected items.\n     * @public\n     */\n    \"selection-change\": {\n      detail: {\n        items: {\n          type: Array\n        }\n      }\n    }\n  }\n};\n/**\n * @class\n *\n * <h3 class=\"comment-api-title\">Overview</h3>\n *\n * The <code>ui5-multi-combobox</code> component consists of a list box with items and a text field allowing the user to either type a value directly into the text field, or choose from the list of existing items.\n *\n * The drop-down list is used for selecting and filtering values, it enables users to select one or more options from a predefined list. The control provides an editable input field to filter the list, and a dropdown arrow to expand/collapse the list of available options.\n * The options in the list have checkboxes that permit multi-selection. Entered values are displayed as tokens.\n * <h3>Structure</h3>\n * The <code>ui5-multi-combobox</code> consists of the following elements:\n * <ul>\n * <li> Tokenizer - a list of tokens with selected options.\n * <li> Input field - displays the selected option/s as token/s. Users can type to filter the list.\n * <li> Drop-down arrow - expands\\collapses the option list.</li>\n * <li> Option list - the list of available options.</li>\n * </ul>\n * <h3>Keyboard Handling</h3>\n *\n * The <code>ui5-multi-combobox</code> provides advanced keyboard handling.\n *\n * <h4>Picker</h4>\n * If the <code>ui5-multi-combobox</code> is focused,\n * you can open or close the drop-down by pressing <code>F4</code>, <code>ALT+UP</code> or <code>ALT+DOWN</code> keys.\n * Once the drop-down is opened, you can use the <code>UP</code> and <code>DOWN</code> arrow keys\n * to navigate through the available options and select one by pressing the <code>Space</code> or <code>Enter</code> keys.\n * <br>\n *\n * <h4>Tokens</h4>\n * <ul>\n * <li> Left/Right arrow keys - moves the focus selection form the currently focused token to the previous/next one (if available). </li>\n * <li> Delete -  deletes the token and focuses the previous token. </li>\n * <li> Backspace -  deletes the token and focus the next token. </li>\n * </ul>\n *\n * <h3>CSS Shadow Parts</h3>\n *\n * <ui5-link target=\"_blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/::part\">CSS Shadow Parts</ui5-link> allow developers to style elements inside the Shadow DOM.\n * <br>\n * The <code>ui5-multi-combobox</code> exposes the following CSS Shadow Parts:\n * <ul>\n * <li>token-{index} - Used to style each token(where <code>token-0</code> corresponds to the first item)</li>\n * </ul>\n *\n * <h3>ES6 Module Import</h3>\n *\n * <code>import \"@ui5/webcomponents/dist/MultiComboBox\";</code>\n *\n *\n * @constructor\n * @author SAP SE\n * @alias sap.ui.webcomponents.main.MultiComboBox\n * @extends UI5Element\n * @tagname ui5-multi-combobox\n * @public\n * @appenddocs MultiComboBoxItem\n * @since 0.11.0\n */\n\nclass MultiComboBox extends UI5Element {\n  static get metadata() {\n    return metadata;\n  }\n\n  static get render() {\n    return litRender;\n  }\n\n  static get template() {\n    return MultiComboBoxTemplate;\n  }\n\n  static get staticAreaTemplate() {\n    return MultiComboBoxPopoverTemplate;\n  }\n\n  static get styles() {\n    return styles;\n  }\n\n  static get staticAreaStyles() {\n    return [ResponsivePopoverCommonCss, ValueStateMessageCss, SuggestionsCss];\n  }\n\n  static get dependencies() {\n    return [MultiComboBoxItem, Tokenizer, Token, Icon, ResponsivePopover, Popover, List, StandardListItem, ToggleButton, Button];\n  }\n\n  constructor() {\n    super();\n    this._filteredItems = [];\n    this.selectedValues = [];\n    this._inputLastValue = \"\";\n    this._valueBeforeOpen = \"\";\n    this._deleting = false;\n    this._validationTimeout = null;\n    this._handleResizeBound = this._handleResize.bind(this);\n  }\n\n  onEnterDOM() {\n    ResizeHandler.register(this, this._handleResizeBound);\n  }\n\n  onExitDOM() {\n    ResizeHandler.deregister(this, this._handleResizeBound);\n  }\n\n  _handleResize() {\n    this._inputWidth = this.offsetWidth;\n  }\n\n  _inputChange() {\n    this.fireEvent(\"change\");\n  }\n\n  togglePopover() {\n    this.allItemsPopover.toggle(this);\n  }\n\n  _showFilteredItems() {\n    this.filterSelected = true;\n    this._showMorePressed = true;\n    this.togglePopover();\n  }\n\n  filterSelectedItems(event) {\n    this.filterSelected = event.target.pressed;\n    this.selectedItems = this._filteredItems.filter(item => item.selected);\n  }\n\n  get _showAllItemsButtonPressed() {\n    return this.filterSelected;\n  }\n\n  get _inputDom() {\n    return this.shadowRoot.querySelector(\"#ui5-multi-combobox-input\");\n  }\n\n  _inputLiveChange(event) {\n    const input = event.target;\n    const value = input.value;\n\n    const filteredItems = this._filterItems(value);\n\n    const oldValueState = this.valueState;\n\n    if (this.filterSelected) {\n      this.filterSelected = false;\n    }\n    /* skip calling change event when an input with a placeholder is focused on IE\n    \t- value of the host and the internal input should be differnt in case of actual input\n    \t- input is called when a key is pressed => keyup should not be called yet\n    */\n\n\n    const skipFiring = this._inputDom.value === this.value && isIE() && !this._keyDown && !!this.placeholder;\n\n    if (skipFiring) {\n      event.preventDefault();\n      return;\n    }\n\n    if (this._validationTimeout) {\n      input.value = this._inputLastValue;\n      return;\n    }\n\n    if (!filteredItems.length && value && !this.allowCustomValues) {\n      input.value = this._inputLastValue;\n      this.valueState = \"Error\";\n\n      this._resetValueState(oldValueState);\n\n      return;\n    }\n\n    this._inputLastValue = input.value;\n    this.value = input.value;\n    this._filteredItems = filteredItems;\n\n    if (!isPhone()) {\n      if (filteredItems.length === 0) {\n        this.allItemsPopover.close();\n      } else {\n        this.allItemsPopover.showAt(this);\n      }\n    }\n\n    this.fireEvent(\"input\");\n  }\n\n  _tokenDelete(event) {\n    const token = event.detail.ref;\n    const deletingItem = this.items.find(item => item._id === token.getAttribute(\"data-ui5-id\"));\n    deletingItem.selected = false;\n    this._deleting = true;\n    this.fireSelectionChange();\n  }\n\n  get _getPlaceholder() {\n    if (this._tokenizer && this._tokenizer.tokens.length) {\n      return \"\";\n    }\n\n    return this.placeholder;\n  }\n\n  _handleLeft() {\n    const cursorPosition = this.getDomRef().querySelector(`input`).selectionStart;\n\n    if (cursorPosition === 0) {\n      this._tokenizer._focusLastToken();\n    }\n  }\n\n  _tokenizerFocusOut(event) {\n    this._tokenizerFocused = false;\n    const tokensCount = this._tokenizer.tokens.length - 1;\n\n    if (!event.relatedTarget || !event.relatedTarget.hasAttribute(\"ui5-token\")) {\n      this._tokenizer.tokens.forEach(token => {\n        token.selected = false;\n      });\n\n      this._tokenizer.scrollToStart();\n    }\n\n    if (tokensCount === 0 && this._deleting) {\n      setTimeout(() => {\n        if (!isPhone()) {\n          this.shadowRoot.querySelector(\"input\").focus();\n        }\n\n        this._deleting = false;\n      }, 0);\n    }\n  }\n\n  _tokenizerFocusIn() {\n    this._tokenizerFocused = true;\n    this.focused = false;\n  }\n\n  _onkeyup() {\n    this._keyDown = false;\n  }\n\n  async _onkeydown(event) {\n    if (isLeft(event)) {\n      this._handleLeft(event);\n    }\n\n    if (isShow(event) && !this.readonly && !this.disabled) {\n      event.preventDefault();\n      this.togglePopover();\n    }\n\n    if (this.open && (isUp(event) || isDown(event))) {\n      this._handleArrowNavigation(event);\n    }\n\n    if (isBackSpace(event) && event.target.value === \"\") {\n      event.preventDefault();\n\n      this._tokenizer._focusLastToken();\n    } // Reset value on ESC\n\n\n    if (isEscape(event) && (!this.allowCustomValues || !this.open && this.allowCustomValues)) {\n      this.value = this._lastValue;\n    }\n\n    if (isEnter(event)) {\n      this.handleEnter();\n    }\n\n    this._keyDown = true;\n  }\n\n  _onValueStateKeydown(event) {\n    const isArrowDown = isDown(event);\n    const isArrowUp = isUp(event);\n    event.preventDefault();\n\n    if (isArrowDown) {\n      this._handleArrowDown(event);\n    }\n\n    if (isArrowUp) {\n      this._inputDom.focus();\n    }\n  }\n\n  _onItemKeydown(event) {\n    const isFirstItem = this.list.items[0] === event.target;\n    event.preventDefault();\n\n    if (!isUp(event) || !isFirstItem) {\n      return;\n    }\n\n    if (this.valueStateHeader) {\n      this.valueStateHeader.focus();\n      return;\n    }\n\n    this._inputDom.focus();\n  }\n\n  async _handleArrowNavigation(event) {\n    const isArrowDown = isDown(event);\n    const hasSuggestions = this.allItemsPopover.opened && this.items.length;\n    event.preventDefault();\n\n    if (this.hasValueStateMessage && !this.valueStateHeader) {\n      await this._setValueStateHeader();\n    }\n\n    if (isArrowDown && this.focused && this.valueStateHeader) {\n      this.valueStateHeader.focus();\n      return;\n    }\n\n    if (isArrowDown && this.focused && hasSuggestions) {\n      this._handleArrowDown(event);\n    }\n  }\n\n  _handleArrowDown(event) {\n    const firstListItem = this.list.items[0];\n\n    this.list._itemNavigation.setCurrentItem(firstListItem);\n\n    firstListItem.focus();\n  }\n\n  handleEnter() {\n    const lowerCaseValue = this.value.toLowerCase();\n    const matchingItem = this.items.find(item => item.text.toLowerCase() === lowerCaseValue);\n    const oldValueState = this.valueState;\n\n    if (matchingItem) {\n      if (matchingItem.selected) {\n        if (this._validationTimeout) {\n          return;\n        }\n\n        this.valueState = \"Error\";\n        this._performingSelectionTwice = true;\n\n        this._resetValueState(oldValueState, () => {\n          this._performingSelectionTwice = false;\n        });\n      } else {\n        matchingItem.selected = true;\n        this.value = \"\";\n        this.fireSelectionChange();\n      }\n\n      this.allItemsPopover.close();\n    }\n  }\n\n  _resetValueState(valueState, callback) {\n    this._validationTimeout = setTimeout(() => {\n      this.valueState = valueState;\n      this._validationTimeout = null;\n      callback && callback();\n    }, 2000);\n  }\n\n  _onTokenizerKeydown(event) {\n    if (isRight(event)) {\n      const lastTokenIndex = this._tokenizer.tokens.length - 1;\n\n      if (this._tokenizer.tokens[lastTokenIndex] === document.activeElement.shadowRoot.activeElement) {\n        setTimeout(() => {\n          this.shadowRoot.querySelector(\"input\").focus();\n        }, 0);\n      }\n    }\n  }\n\n  _filterItems(str) {\n    return (Filters[this.filter] || Filters.StartsWithPerTerm)(str, this.items);\n  }\n\n  _afterOpenPicker() {\n    this._toggle();\n\n    if (!isPhone()) {\n      this._innerInput.focus();\n    } else {\n      this.allItemsPopover.focus();\n    }\n  }\n\n  _toggle() {\n    this.open = !this.open;\n    this.fireEvent(\"open-change\");\n  }\n\n  _getSelectedItems() {\n    // Angular 2 way data binding\n    this.selectedValues = this.items.filter(item => item.selected);\n    return this.selectedValues;\n  }\n\n  _listSelectionChange(event) {\n    // sync list items and cb items\n    this.syncItems(event.target.items); // don't call selection change right after selection as user can cancel it on phone\n\n    if (!isPhone()) {\n      this.fireSelectionChange();\n    }\n\n    if (!event.detail.selectionComponentPressed && !isSpace(event.detail)) {\n      this.allItemsPopover.close();\n      this.value = \"\"; // if the item (not checkbox) is clicked, call the selection change\n\n      if (isPhone()) {\n        this.fireSelectionChange();\n      }\n\n      this.fireEvent(\"input\");\n    }\n  }\n\n  syncItems(listItems) {\n    listItems.forEach(item => {\n      this.items.forEach(mcbItem => {\n        if (mcbItem._id === item.getAttribute(\"data-ui5-token-id\")) {\n          mcbItem.selected = item.selected;\n        }\n      });\n    });\n  }\n\n  fireSelectionChange() {\n    this.fireEvent(\"selection-change\", {\n      items: this._getSelectedItems()\n    }); // Angular 2 way data binding\n\n    this.fireEvent(\"value-changed\");\n  }\n\n  async _getRespPopover() {\n    const staticAreaItem = await this.getStaticAreaItemDomRef();\n    this.allItemsPopover = staticAreaItem.querySelector(`.ui5-multi-combobox-all-items-responsive-popover`);\n  }\n\n  async _getList() {\n    const staticAreaItem = await this.getStaticAreaItemDomRef();\n    this.list = staticAreaItem.querySelector(\".ui5-multi-combobox-all-items-list\");\n  }\n\n  _click(event) {\n    if (isPhone() && !this.readonly && !this._showMorePressed && !this._deleting) {\n      this.allItemsPopover.showAt(this);\n    }\n\n    this._showMorePressed = false;\n  }\n\n  _afterClosePicker() {\n    // close device's keyboard and prevent further typing\n    if (isPhone()) {\n      this.blur();\n    }\n\n    this._toggle();\n\n    this._iconPressed = false;\n    this.filterSelected = false;\n  }\n\n  _beforeOpen() {\n    this._itemsBeforeOpen = this.items.map(item => {\n      return {\n        ref: item,\n        selected: item.selected\n      };\n    });\n    this._valueBeforeOpen = this.value;\n\n    if (this.filterSelected) {\n      this.selectedItems = this._filteredItems.filter(item => item.selected);\n    }\n  }\n\n  onBeforeRendering() {\n    const input = this.shadowRoot.querySelector(\"input\");\n    this._inputLastValue = this.value;\n\n    if (input && !input.value) {\n      this._filteredItems = this.items;\n    }\n\n    this.items.forEach(item => {\n      item._getRealDomRef = () => this.allItemsPopover.querySelector(`*[data-ui5-stable=${item.stableDomRef}]`);\n    });\n\n    const filteredItems = this._filterItems(this.value);\n\n    this._filteredItems = filteredItems;\n  }\n\n  async onAfterRendering() {\n    await this._getRespPopover();\n    await this._getList();\n    this.toggle(this.shouldDisplayOnlyValueStateMessage);\n    this.storeResponsivePopoverWidth();\n    this._deleting = false;\n  }\n\n  get _isPhone() {\n    return isPhone();\n  }\n\n  _onIconMousedown() {\n    this._iconPressed = true;\n  }\n\n  storeResponsivePopoverWidth() {\n    if (this.open && !this._listWidth) {\n      this._listWidth = this.list.offsetWidth;\n    }\n  }\n\n  toggle(isToggled) {\n    if (isToggled && !this.open) {\n      this.openPopover();\n    } else {\n      this.closePopover();\n    }\n  }\n\n  handleCancel() {\n    this._itemsBeforeOpen.forEach(item => {\n      item.ref.selected = item.selected;\n    });\n\n    this.togglePopover();\n    this.value = this._valueBeforeOpen;\n  }\n\n  handleOK() {\n    if (isPhone()) {\n      this.fireSelectionChange();\n    }\n\n    this.togglePopover();\n  }\n\n  async openPopover() {\n    const popover = await this._getPopover();\n\n    if (popover) {\n      popover.showAt(this);\n    }\n  }\n\n  _forwardFocusToInner() {\n    this._innerInput.focus();\n  }\n\n  async closePopover() {\n    const popover = await this._getPopover();\n    popover && popover.close();\n  }\n\n  async _getPopover() {\n    const staticAreaItem = await this.getStaticAreaItemDomRef();\n    return staticAreaItem.querySelector(\"[ui5-popover]\");\n  }\n\n  async _getResponsivePopover() {\n    const staticAreaItem = await this.getStaticAreaItemDomRef();\n    return staticAreaItem.querySelector(\"[ui5-responsive-popover]\");\n  }\n\n  async _setValueStateHeader() {\n    const responsivePopover = await this._getResponsivePopover();\n    this.valueStateHeader = responsivePopover.querySelector(\"div.ui5-responsive-popover-header.ui5-valuestatemessage-root\");\n  }\n\n  get _tokenizer() {\n    return this.shadowRoot.querySelector(\"[ui5-tokenizer]\");\n  }\n\n  inputFocusIn() {\n    if (!isPhone() || this.readonly) {\n      this.focused = true;\n    } else {\n      this._innerInput.blur();\n    }\n\n    this._lastValue = this.value;\n  }\n\n  inputFocusOut(event) {\n    if (!this.shadowRoot.contains(event.relatedTarget) && !this._deleting) {\n      this.focused = false; // remove the value if user focus out the input and focus is not going in the popover\n\n      if (!isPhone() && !this.allowCustomValues && this.staticAreaItem !== event.relatedTarget) {\n        this.value = \"\";\n      }\n    }\n  }\n\n  _readonlyIconClick() {\n    this._inputDom.focus();\n  }\n\n  get editable() {\n    return !this.readonly;\n  }\n\n  get _isFocusInside() {\n    return !isPhone() && (this.focused || this._tokenizerFocused);\n  }\n\n  get selectedItemsListMode() {\n    return this.readonly ? \"None\" : \"MultiSelect\";\n  }\n\n  get _listItemsType() {\n    return this.readonly ? \"Inactive\" : \"Active\";\n  }\n\n  get hasValueState() {\n    return this.valueState !== ValueState.None;\n  }\n\n  get hasValueStateMessage() {\n    return this.hasValueState && this.valueState !== ValueState.Success;\n  }\n\n  get valueStateText() {\n    let key = this.valueState;\n\n    if (this._performingSelectionTwice) {\n      key = \"Error_Selection\";\n    }\n\n    return this.valueStateTextMappings[key];\n  }\n\n  get valueStateTextId() {\n    return this.hasValueState ? `${this._id}-valueStateDesc` : undefined;\n  }\n\n  get valueStateMessageText() {\n    return this.getSlottedNodes(\"valueStateMessage\").map(el => el.cloneNode(true));\n  }\n  /**\n   * This method is relevant for sap_horizon theme only\n   */\n\n\n  get _valueStateMessageIcon() {\n    const iconPerValueState = {\n      Error: \"error\",\n      Warning: \"alert\",\n      Success: \"sys-enter-2\",\n      Information: \"information\"\n    };\n    return this.valueState !== ValueState.None ? iconPerValueState[this.valueState] : \"\";\n  }\n\n  get _tokensCountText() {\n    if (!this._tokenizer) {\n      return;\n    }\n\n    return this._tokenizer._tokensCountText();\n  }\n\n  get _tokensCountTextId() {\n    return `${this._id}-hiddenText-nMore`;\n  }\n\n  get ariaDescribedByText() {\n    return this.valueStateTextId ? `${this._tokensCountTextId} ${this.valueStateTextId}` : `${this._tokensCountTextId}`;\n  }\n\n  get shouldDisplayDefaultValueStateMessage() {\n    return !this.valueStateMessage.length && this.hasValueStateMessage;\n  }\n\n  get shouldDisplayOnlyValueStateMessage() {\n    return this.focused && !this.readonly && this.hasValueStateMessage && !this._iconPressed;\n  }\n\n  get valueStateTextMappings() {\n    return {\n      \"Success\": MultiComboBox.i18nBundle.getText(VALUE_STATE_SUCCESS),\n      \"Error\": MultiComboBox.i18nBundle.getText(VALUE_STATE_ERROR),\n      \"Error_Selection\": MultiComboBox.i18nBundle.getText(VALUE_STATE_ERROR_ALREADY_SELECTED),\n      \"Warning\": MultiComboBox.i18nBundle.getText(VALUE_STATE_WARNING),\n      \"Information\": MultiComboBox.i18nBundle.getText(VALUE_STATE_INFORMATION)\n    };\n  }\n\n  get _innerInput() {\n    if (isPhone()) {\n      if (this.allItemsPopover.opened) {\n        return this.allItemsPopover.querySelector(\"input\");\n      }\n    }\n\n    return this.getDomRef().querySelector(\"#ui5-multi-combobox-input\");\n  }\n\n  get _headerTitleText() {\n    return MultiComboBox.i18nBundle.getText(INPUT_SUGGESTIONS_TITLE);\n  }\n\n  get _iconAccessibleNameText() {\n    return MultiComboBox.i18nBundle.getText(SELECT_OPTIONS);\n  }\n\n  get _dialogOkButton() {\n    return MultiComboBox.i18nBundle.getText(MULTICOMBOBOX_DIALOG_OK_BUTTON);\n  }\n\n  get _tokenizerExpanded() {\n    return (this._isFocusInside || this.open) && !this.readonly;\n  }\n\n  get _valueStatePopoverHorizontalAlign() {\n    return this.effectiveDir !== \"rtl\" ? \"Left\" : \"Right\";\n  }\n\n  get classes() {\n    return {\n      popover: {\n        \"ui5-multi-combobox-all-items-responsive-popover\": true,\n        \"ui5-suggestions-popover\": !this.isPhone,\n        \"ui5-suggestions-popover-with-value-state-header\": !this.isPhone && this.hasValueStateMessage\n      },\n      popoverValueState: {\n        \"ui5-valuestatemessage-root\": true,\n        \"ui5-valuestatemessage-header\": true,\n        \"ui5-valuestatemessage--success\": this.valueState === ValueState.Success,\n        \"ui5-valuestatemessage--error\": this.valueState === ValueState.Error,\n        \"ui5-valuestatemessage--warning\": this.valueState === ValueState.Warning,\n        \"ui5-valuestatemessage--information\": this.valueState === ValueState.Information\n      }\n    };\n  }\n\n  get styles() {\n    return {\n      popoverValueStateMessage: {\n        \"width\": `${this._listWidth}px`,\n        \"display\": this._listWidth === 0 ? \"none\" : \"inline-block\"\n      },\n      popoverHeader: {\n        \"max-width\": isPhone() ? \"100%\" : `${this._inputWidth}px`\n      }\n    };\n  }\n\n  static async onDefine() {\n    MultiComboBox.i18nBundle = await getI18nBundle(\"@ui5/webcomponents\");\n  }\n\n}\n\nMultiComboBox.define();\nexport default MultiComboBox;","map":{"version":3,"sources":["/Users/flo/Desktop/mdao.fioriapp/node_modules/@ui5/webcomponents/dist/MultiComboBox.js"],"names":["UI5Element","litRender","ResizeHandler","ValueState","isShow","isDown","isUp","isBackSpace","isSpace","isLeft","isRight","isEscape","isEnter","Integer","isIE","isPhone","getI18nBundle","MultiComboBoxItem","Tokenizer","Token","Icon","Popover","ResponsivePopover","List","StandardListItem","ToggleButton","Filters","Button","VALUE_STATE_SUCCESS","VALUE_STATE_ERROR","VALUE_STATE_WARNING","VALUE_STATE_INFORMATION","INPUT_SUGGESTIONS_TITLE","SELECT_OPTIONS","MULTICOMBOBOX_DIALOG_OK_BUTTON","VALUE_STATE_ERROR_ALREADY_SELECTED","MultiComboBoxTemplate","MultiComboBoxPopoverTemplate","styles","ResponsivePopoverCommonCss","ValueStateMessageCss","SuggestionsCss","metadata","tag","languageAware","managedSlots","slots","propertyName","type","HTMLElement","invalidateOnChildChange","icon","valueStateMessage","properties","value","String","defaultValue","placeholder","allowCustomValues","Boolean","disabled","valueState","None","readonly","required","filter","open","_filteredItems","Object","filterSelected","focused","_tokenizerFocused","_iconPressed","noAttribute","_inputWidth","_listWidth","_performingSelectionTwice","events","change","input","detail","items","Array","MultiComboBox","render","template","staticAreaTemplate","staticAreaStyles","dependencies","constructor","selectedValues","_inputLastValue","_valueBeforeOpen","_deleting","_validationTimeout","_handleResizeBound","_handleResize","bind","onEnterDOM","register","onExitDOM","deregister","offsetWidth","_inputChange","fireEvent","togglePopover","allItemsPopover","toggle","_showFilteredItems","_showMorePressed","filterSelectedItems","event","target","pressed","selectedItems","item","selected","_showAllItemsButtonPressed","_inputDom","shadowRoot","querySelector","_inputLiveChange","filteredItems","_filterItems","oldValueState","skipFiring","_keyDown","preventDefault","length","_resetValueState","close","showAt","_tokenDelete","token","ref","deletingItem","find","_id","getAttribute","fireSelectionChange","_getPlaceholder","_tokenizer","tokens","_handleLeft","cursorPosition","getDomRef","selectionStart","_focusLastToken","_tokenizerFocusOut","tokensCount","relatedTarget","hasAttribute","forEach","scrollToStart","setTimeout","focus","_tokenizerFocusIn","_onkeyup","_onkeydown","_handleArrowNavigation","_lastValue","handleEnter","_onValueStateKeydown","isArrowDown","isArrowUp","_handleArrowDown","_onItemKeydown","isFirstItem","list","valueStateHeader","hasSuggestions","opened","hasValueStateMessage","_setValueStateHeader","firstListItem","_itemNavigation","setCurrentItem","lowerCaseValue","toLowerCase","matchingItem","text","callback","_onTokenizerKeydown","lastTokenIndex","document","activeElement","str","StartsWithPerTerm","_afterOpenPicker","_toggle","_innerInput","_getSelectedItems","_listSelectionChange","syncItems","selectionComponentPressed","listItems","mcbItem","_getRespPopover","staticAreaItem","getStaticAreaItemDomRef","_getList","_click","_afterClosePicker","blur","_beforeOpen","_itemsBeforeOpen","map","onBeforeRendering","_getRealDomRef","stableDomRef","onAfterRendering","shouldDisplayOnlyValueStateMessage","storeResponsivePopoverWidth","_isPhone","_onIconMousedown","isToggled","openPopover","closePopover","handleCancel","handleOK","popover","_getPopover","_forwardFocusToInner","_getResponsivePopover","responsivePopover","inputFocusIn","inputFocusOut","contains","_readonlyIconClick","editable","_isFocusInside","selectedItemsListMode","_listItemsType","hasValueState","Success","valueStateText","key","valueStateTextMappings","valueStateTextId","undefined","valueStateMessageText","getSlottedNodes","el","cloneNode","_valueStateMessageIcon","iconPerValueState","Error","Warning","Information","_tokensCountText","_tokensCountTextId","ariaDescribedByText","shouldDisplayDefaultValueStateMessage","i18nBundle","getText","_headerTitleText","_iconAccessibleNameText","_dialogOkButton","_tokenizerExpanded","_valueStatePopoverHorizontalAlign","effectiveDir","classes","popoverValueState","popoverValueStateMessage","popoverHeader","onDefine","define"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,4CAAvB;AACA,OAAOC,SAAP,MAAsB,sDAAtB;AACA,OAAOC,aAAP,MAA0B,wDAA1B;AACA,OAAOC,UAAP,MAAuB,kDAAvB;AACA,SACCC,MADD,EAECC,MAFD,EAGCC,IAHD,EAICC,WAJD,EAKCC,OALD,EAMCC,MAND,EAOCC,OAPD,EAQCC,QARD,EASCC,OATD,QAUO,sCAVP;AAWA,OAAOC,OAAP,MAAoB,+CAApB;AACA,OAAO,kDAAP;AACA,SAASC,IAAT,EAAeC,OAAf,QAA8B,wCAA9B;AACA,SAASC,aAAT,QAA8B,4CAA9B;AACA,OAAO,0CAAP;AACA,OAAO,kDAAP;AACA,OAAO,+CAAP;AACA,OAAOC,iBAAP,MAA8B,wBAA9B;AACA,OAAOC,SAAP,MAAsB,gBAAtB;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,OAAP,MAAoB,cAApB;AACA,OAAOC,iBAAP,MAA8B,wBAA9B;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,gBAAP,MAA6B,uBAA7B;AACA,OAAOC,YAAP,MAAyB,mBAAzB;AACA,OAAO,KAAKC,OAAZ,MAAyB,sBAAzB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,SACCC,mBADD,EAECC,iBAFD,EAGCC,mBAHD,EAICC,uBAJD,EAKCC,uBALD,EAMCC,cAND,EAOCC,8BAPD,EAQCC,kCARD,QASO,mCATP,C,CAWA;;AACA,OAAOC,qBAAP,MAAkC,oDAAlC;AACA,OAAOC,4BAAP,MAAyC,2DAAzC,C,CAEA;;AACA,OAAOC,MAAP,MAAmB,yCAAnB;AACA,OAAOC,0BAAP,MAAuC,mDAAvC;AACA,OAAOC,oBAAP,MAAiC,6CAAjC;AACA,OAAOC,cAAP,MAA2B,uCAA3B;AAEA;AACA;AACA;;AACA,MAAMC,QAAQ,GAAG;AAChBC,EAAAA,GAAG,EAAE,oBADW;AAEhBC,EAAAA,aAAa,EAAE,IAFC;AAGhBC,EAAAA,YAAY,EAAE,IAHE;AAIhBC,EAAAA,KAAK;AAAE;AAAgE;AACtE;AACF;AACA;AACA;AACA;AACA;AACA;AACE,eAAW;AACVC,MAAAA,YAAY,EAAE,OADJ;AAEVC,MAAAA,IAAI,EAAEC,WAFI;AAGVC,MAAAA,uBAAuB,EAAE;AAHf,KAR2D;;AActE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,IAAAA,IAAI,EAAE;AACLH,MAAAA,IAAI,EAAEC;AADD,KAtBgE;;AA0BtE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEG,IAAAA,iBAAiB,EAAE;AAClBJ,MAAAA,IAAI,EAAEC;AADY;AAvCmD,GAJvD;AA+ChBI,EAAAA,UAAU;AAAE;AAAgE;AAC3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,IAAAA,KAAK,EAAE;AACNN,MAAAA,IAAI,EAAEO,MADA;AAENC,MAAAA,YAAY,EAAE;AAFR,KAVoE;;AAe3E;AACF;AACA;AACA;AACA;AACA;AACA;AACEC,IAAAA,WAAW,EAAE;AACZT,MAAAA,IAAI,EAAEO,MADM;AAEZC,MAAAA,YAAY,EAAE;AAFF,KAtB8D;;AA2B3E;AACF;AACA;AACA;AACA;AACA;AACA;AACEE,IAAAA,iBAAiB,EAAE;AAClBV,MAAAA,IAAI,EAAEW;AADY,KAlCwD;;AAsC3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,IAAAA,QAAQ,EAAE;AACTZ,MAAAA,IAAI,EAAEW;AADG,KA/CiE;;AAmD3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEE,IAAAA,UAAU,EAAE;AACXb,MAAAA,IAAI,EAAE7C,UADK;AAEXqD,MAAAA,YAAY,EAAErD,UAAU,CAAC2D;AAFd,KAnE+D;;AAwE3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,IAAAA,QAAQ,EAAE;AACTf,MAAAA,IAAI,EAAEW;AADG,KAlFiE;;AAsF3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACEK,IAAAA,QAAQ,EAAE;AACThB,MAAAA,IAAI,EAAEW;AADG,KA9FiE;;AAkG3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACEM,IAAAA,MAAM,EAAE;AACPjB,MAAAA,IAAI,EAAEO,MADC;AAEPC,MAAAA,YAAY,EAAE;AAFP,KA1GmE;;AA+G3E;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEU,IAAAA,IAAI,EAAE;AACLlB,MAAAA,IAAI,EAAEW;AADD,KAxHqE;AA4H3EQ,IAAAA,cAAc,EAAE;AACfnB,MAAAA,IAAI,EAAEoB;AADS,KA5H2D;AAgI3EC,IAAAA,cAAc,EAAE;AACfrB,MAAAA,IAAI,EAAEW;AADS,KAhI2D;AAoI3EW,IAAAA,OAAO,EAAE;AACRtB,MAAAA,IAAI,EAAEW;AADE,KApIkE;AAwI3EY,IAAAA,iBAAiB,EAAE;AAClBvB,MAAAA,IAAI,EAAEW;AADY,KAxIwD;AA4I3Ea,IAAAA,YAAY,EAAE;AACbxB,MAAAA,IAAI,EAAEW,OADO;AAEbc,MAAAA,WAAW,EAAE;AAFA,KA5I6D;AAiJ3EC,IAAAA,WAAW,EAAE;AACZ1B,MAAAA,IAAI,EAAEnC,OADM;AAEZ4D,MAAAA,WAAW,EAAE;AAFD,KAjJ8D;AAsJ3EE,IAAAA,UAAU,EAAE;AACX3B,MAAAA,IAAI,EAAEnC,OADK;AAEX2C,MAAAA,YAAY,EAAE,CAFH;AAGXiB,MAAAA,WAAW,EAAE;AAHF,KAtJ+D;AA4J3EG,IAAAA,yBAAyB,EAAE;AAC1B5B,MAAAA,IAAI,EAAEW;AADoB;AA5JgD,GA/C5D;AA+MhBkB,EAAAA,MAAM;AAAE;AAAgE;AACvE;AACF;AACA;AACA;AACA;AACA;AACEC,IAAAA,MAAM,EAAE,EAP+D;;AASvE;AACF;AACA;AACA;AACA;AACA;AACEC,IAAAA,KAAK,EAAE,EAfgE;;AAiBvE;AACF;AACA;AACA;AACA;AACA;AACA;AACE,mBAAe,EAxBwD;;AA0BvE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACE,wBAAoB;AACnBC,MAAAA,MAAM,EAAE;AACPC,QAAAA,KAAK,EAAE;AAAEjC,UAAAA,IAAI,EAAEkC;AAAR;AADA;AADW;AAlCmD;AA/MxD,CAAjB;AAyPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,aAAN,SAA4BnF,UAA5B,CAAuC;AACnB,aAAR0C,QAAQ,GAAG;AACrB,WAAOA,QAAP;AACA;;AAEgB,aAAN0C,MAAM,GAAG;AACnB,WAAOnF,SAAP;AACA;;AAEkB,aAARoF,QAAQ,GAAG;AACrB,WAAOjD,qBAAP;AACA;;AAE4B,aAAlBkD,kBAAkB,GAAG;AAC/B,WAAOjD,4BAAP;AACA;;AAEgB,aAANC,MAAM,GAAG;AACnB,WAAOA,MAAP;AACA;;AAE0B,aAAhBiD,gBAAgB,GAAG;AAC7B,WAAO,CAAChD,0BAAD,EAA6BC,oBAA7B,EAAmDC,cAAnD,CAAP;AACA;;AAEsB,aAAZ+C,YAAY,GAAG;AACzB,WAAO,CACNvE,iBADM,EAENC,SAFM,EAGNC,KAHM,EAINC,IAJM,EAKNE,iBALM,EAMND,OANM,EAONE,IAPM,EAQNC,gBARM,EASNC,YATM,EAUNE,MAVM,CAAP;AAYA;;AAED8D,EAAAA,WAAW,GAAG;AACb;AAEA,SAAKtB,cAAL,GAAsB,EAAtB;AACA,SAAKuB,cAAL,GAAsB,EAAtB;AACA,SAAKC,eAAL,GAAuB,EAAvB;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,SAAL,GAAiB,KAAjB;AACA,SAAKC,kBAAL,GAA0B,IAA1B;AACA,SAAKC,kBAAL,GAA0B,KAAKC,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAA1B;AACA;;AAEDC,EAAAA,UAAU,GAAG;AACZhG,IAAAA,aAAa,CAACiG,QAAd,CAAuB,IAAvB,EAA6B,KAAKJ,kBAAlC;AACA;;AAEDK,EAAAA,SAAS,GAAG;AACXlG,IAAAA,aAAa,CAACmG,UAAd,CAAyB,IAAzB,EAA+B,KAAKN,kBAApC;AACA;;AAEDC,EAAAA,aAAa,GAAG;AACf,SAAKtB,WAAL,GAAmB,KAAK4B,WAAxB;AACA;;AAEDC,EAAAA,YAAY,GAAG;AACd,SAAKC,SAAL,CAAe,QAAf;AACA;;AAEDC,EAAAA,aAAa,GAAG;AACf,SAAKC,eAAL,CAAqBC,MAArB,CAA4B,IAA5B;AACA;;AAEDC,EAAAA,kBAAkB,GAAG;AACpB,SAAKvC,cAAL,GAAsB,IAAtB;AACA,SAAKwC,gBAAL,GAAwB,IAAxB;AAEA,SAAKJ,aAAL;AACA;;AAEDK,EAAAA,mBAAmB,CAACC,KAAD,EAAQ;AAC1B,SAAK1C,cAAL,GAAsB0C,KAAK,CAACC,MAAN,CAAaC,OAAnC;AACA,SAAKC,aAAL,GAAqB,KAAK/C,cAAL,CAAoBF,MAApB,CAA2BkD,IAAI,IAAIA,IAAI,CAACC,QAAxC,CAArB;AACA;;AAE6B,MAA1BC,0BAA0B,GAAG;AAChC,WAAO,KAAKhD,cAAZ;AACA;;AAEY,MAATiD,SAAS,GAAG;AACf,WAAO,KAAKC,UAAL,CAAgBC,aAAhB,CAA8B,2BAA9B,CAAP;AACA;;AAEDC,EAAAA,gBAAgB,CAACV,KAAD,EAAQ;AACvB,UAAMhC,KAAK,GAAGgC,KAAK,CAACC,MAApB;AACA,UAAM1D,KAAK,GAAGyB,KAAK,CAACzB,KAApB;;AACA,UAAMoE,aAAa,GAAG,KAAKC,YAAL,CAAkBrE,KAAlB,CAAtB;;AACA,UAAMsE,aAAa,GAAG,KAAK/D,UAA3B;;AAEA,QAAI,KAAKQ,cAAT,EAAyB;AACxB,WAAKA,cAAL,GAAsB,KAAtB;AACA;AAED;AACF;AACA;AACA;;;AACE,UAAMwD,UAAU,GAAI,KAAKP,SAAL,CAAehE,KAAf,KAAyB,KAAKA,KAA/B,IAAyCxC,IAAI,EAA7C,IAAmD,CAAC,KAAKgH,QAAzD,IAAqE,CAAC,CAAC,KAAKrE,WAA/F;;AAEA,QAAIoE,UAAJ,EAAgB;AACfd,MAAAA,KAAK,CAACgB,cAAN;AAEA;AACA;;AAED,QAAI,KAAKjC,kBAAT,EAA6B;AAC5Bf,MAAAA,KAAK,CAACzB,KAAN,GAAc,KAAKqC,eAAnB;AACA;AACA;;AAED,QAAI,CAAC+B,aAAa,CAACM,MAAf,IAAyB1E,KAAzB,IAAkC,CAAC,KAAKI,iBAA5C,EAA+D;AAC9DqB,MAAAA,KAAK,CAACzB,KAAN,GAAc,KAAKqC,eAAnB;AACA,WAAK9B,UAAL,GAAkB,OAAlB;;AAEA,WAAKoE,gBAAL,CAAsBL,aAAtB;;AAEA;AACA;;AAED,SAAKjC,eAAL,GAAuBZ,KAAK,CAACzB,KAA7B;AACA,SAAKA,KAAL,GAAayB,KAAK,CAACzB,KAAnB;AACA,SAAKa,cAAL,GAAsBuD,aAAtB;;AAEA,QAAI,CAAC3G,OAAO,EAAZ,EAAgB;AACf,UAAI2G,aAAa,CAACM,MAAd,KAAyB,CAA7B,EAAgC;AAC/B,aAAKtB,eAAL,CAAqBwB,KAArB;AACA,OAFD,MAEO;AACN,aAAKxB,eAAL,CAAqByB,MAArB,CAA4B,IAA5B;AACA;AACD;;AAED,SAAK3B,SAAL,CAAe,OAAf;AACA;;AAED4B,EAAAA,YAAY,CAACrB,KAAD,EAAQ;AACnB,UAAMsB,KAAK,GAAGtB,KAAK,CAAC/B,MAAN,CAAasD,GAA3B;AACA,UAAMC,YAAY,GAAG,KAAKtD,KAAL,CAAWuD,IAAX,CAAgBrB,IAAI,IAAIA,IAAI,CAACsB,GAAL,KAAaJ,KAAK,CAACK,YAAN,CAAmB,aAAnB,CAArC,CAArB;AAEAH,IAAAA,YAAY,CAACnB,QAAb,GAAwB,KAAxB;AACA,SAAKvB,SAAL,GAAiB,IAAjB;AAEA,SAAK8C,mBAAL;AACA;;AAEkB,MAAfC,eAAe,GAAG;AACrB,QAAI,KAAKC,UAAL,IAAmB,KAAKA,UAAL,CAAgBC,MAAhB,CAAuBd,MAA9C,EAAsD;AACrD,aAAO,EAAP;AACA;;AAED,WAAO,KAAKvE,WAAZ;AACA;;AAEDsF,EAAAA,WAAW,GAAG;AACb,UAAMC,cAAc,GAAG,KAAKC,SAAL,GAAiBzB,aAAjB,CAAgC,OAAhC,EAAwC0B,cAA/D;;AAEA,QAAIF,cAAc,KAAK,CAAvB,EAA0B;AACzB,WAAKH,UAAL,CAAgBM,eAAhB;AACA;AACD;;AAEDC,EAAAA,kBAAkB,CAACrC,KAAD,EAAQ;AACzB,SAAKxC,iBAAL,GAAyB,KAAzB;AAEA,UAAM8E,WAAW,GAAG,KAAKR,UAAL,CAAgBC,MAAhB,CAAuBd,MAAvB,GAAgC,CAApD;;AAEA,QAAI,CAACjB,KAAK,CAACuC,aAAP,IAAwB,CAACvC,KAAK,CAACuC,aAAN,CAAoBC,YAApB,CAAiC,WAAjC,CAA7B,EAA4E;AAC3E,WAAKV,UAAL,CAAgBC,MAAhB,CAAuBU,OAAvB,CAA+BnB,KAAK,IAAI;AAAEA,QAAAA,KAAK,CAACjB,QAAN,GAAiB,KAAjB;AAAyB,OAAnE;;AACA,WAAKyB,UAAL,CAAgBY,aAAhB;AACA;;AAED,QAAIJ,WAAW,KAAK,CAAhB,IAAqB,KAAKxD,SAA9B,EAAyC;AACxC6D,MAAAA,UAAU,CAAC,MAAM;AAChB,YAAI,CAAC3I,OAAO,EAAZ,EAAgB;AACf,eAAKwG,UAAL,CAAgBC,aAAhB,CAA8B,OAA9B,EAAuCmC,KAAvC;AACA;;AAED,aAAK9D,SAAL,GAAiB,KAAjB;AACA,OANS,EAMP,CANO,CAAV;AAOA;AACD;;AAED+D,EAAAA,iBAAiB,GAAG;AACnB,SAAKrF,iBAAL,GAAyB,IAAzB;AACA,SAAKD,OAAL,GAAe,KAAf;AACA;;AAEDuF,EAAAA,QAAQ,GAAG;AACV,SAAK/B,QAAL,GAAgB,KAAhB;AACA;;AAEe,QAAVgC,UAAU,CAAC/C,KAAD,EAAQ;AACvB,QAAItG,MAAM,CAACsG,KAAD,CAAV,EAAmB;AAClB,WAAKgC,WAAL,CAAiBhC,KAAjB;AACA;;AAED,QAAI3G,MAAM,CAAC2G,KAAD,CAAN,IAAiB,CAAC,KAAKhD,QAAvB,IAAmC,CAAC,KAAKH,QAA7C,EAAuD;AACtDmD,MAAAA,KAAK,CAACgB,cAAN;AACA,WAAKtB,aAAL;AACA;;AAED,QAAI,KAAKvC,IAAL,KAAc5D,IAAI,CAACyG,KAAD,CAAJ,IAAe1G,MAAM,CAAC0G,KAAD,CAAnC,CAAJ,EAAiD;AAChD,WAAKgD,sBAAL,CAA4BhD,KAA5B;AACA;;AAED,QAAIxG,WAAW,CAACwG,KAAD,CAAX,IAAsBA,KAAK,CAACC,MAAN,CAAa1D,KAAb,KAAuB,EAAjD,EAAqD;AACpDyD,MAAAA,KAAK,CAACgB,cAAN;;AAEA,WAAKc,UAAL,CAAgBM,eAAhB;AACA,KAlBsB,CAoBvB;;;AACA,QAAIxI,QAAQ,CAACoG,KAAD,CAAR,KAAoB,CAAC,KAAKrD,iBAAN,IAA4B,CAAC,KAAKQ,IAAN,IAAc,KAAKR,iBAAnE,CAAJ,EAA4F;AAC3F,WAAKJ,KAAL,GAAa,KAAK0G,UAAlB;AACA;;AAED,QAAIpJ,OAAO,CAACmG,KAAD,CAAX,EAAoB;AACnB,WAAKkD,WAAL;AACA;;AAED,SAAKnC,QAAL,GAAgB,IAAhB;AACA;;AAEDoC,EAAAA,oBAAoB,CAACnD,KAAD,EAAQ;AAC3B,UAAMoD,WAAW,GAAG9J,MAAM,CAAC0G,KAAD,CAA1B;AACA,UAAMqD,SAAS,GAAG9J,IAAI,CAACyG,KAAD,CAAtB;AAEAA,IAAAA,KAAK,CAACgB,cAAN;;AAEA,QAAIoC,WAAJ,EAAiB;AAChB,WAAKE,gBAAL,CAAsBtD,KAAtB;AACA;;AAED,QAAIqD,SAAJ,EAAe;AACd,WAAK9C,SAAL,CAAeqC,KAAf;AACA;AACD;;AAEDW,EAAAA,cAAc,CAACvD,KAAD,EAAQ;AACrB,UAAMwD,WAAW,GAAG,KAAKC,IAAL,CAAUvF,KAAV,CAAgB,CAAhB,MAAuB8B,KAAK,CAACC,MAAjD;AAEAD,IAAAA,KAAK,CAACgB,cAAN;;AAEA,QAAI,CAACzH,IAAI,CAACyG,KAAD,CAAL,IAAgB,CAACwD,WAArB,EAAkC;AACjC;AACA;;AAED,QAAI,KAAKE,gBAAT,EAA2B;AAC1B,WAAKA,gBAAL,CAAsBd,KAAtB;AACA;AACA;;AAED,SAAKrC,SAAL,CAAeqC,KAAf;AACA;;AAE2B,QAAtBI,sBAAsB,CAAChD,KAAD,EAAQ;AACnC,UAAMoD,WAAW,GAAG9J,MAAM,CAAC0G,KAAD,CAA1B;AACA,UAAM2D,cAAc,GAAG,KAAKhE,eAAL,CAAqBiE,MAArB,IAA+B,KAAK1F,KAAL,CAAW+C,MAAjE;AAEAjB,IAAAA,KAAK,CAACgB,cAAN;;AAEA,QAAI,KAAK6C,oBAAL,IAA6B,CAAC,KAAKH,gBAAvC,EAAyD;AACxD,YAAM,KAAKI,oBAAL,EAAN;AACA;;AAED,QAAIV,WAAW,IAAI,KAAK7F,OAApB,IAA+B,KAAKmG,gBAAxC,EAA0D;AACzD,WAAKA,gBAAL,CAAsBd,KAAtB;AACA;AACA;;AAED,QAAIQ,WAAW,IAAI,KAAK7F,OAApB,IAA+BoG,cAAnC,EAAmD;AAClD,WAAKL,gBAAL,CAAsBtD,KAAtB;AACA;AACD;;AAEDsD,EAAAA,gBAAgB,CAACtD,KAAD,EAAQ;AACvB,UAAM+D,aAAa,GAAG,KAAKN,IAAL,CAAUvF,KAAV,CAAgB,CAAhB,CAAtB;;AAEA,SAAKuF,IAAL,CAAUO,eAAV,CAA0BC,cAA1B,CAAyCF,aAAzC;;AACAA,IAAAA,aAAa,CAACnB,KAAd;AACA;;AAEDM,EAAAA,WAAW,GAAG;AACb,UAAMgB,cAAc,GAAG,KAAK3H,KAAL,CAAW4H,WAAX,EAAvB;AACA,UAAMC,YAAY,GAAG,KAAKlG,KAAL,CAAWuD,IAAX,CAAgBrB,IAAI,IAAIA,IAAI,CAACiE,IAAL,CAAUF,WAAV,OAA4BD,cAApD,CAArB;AACA,UAAMrD,aAAa,GAAG,KAAK/D,UAA3B;;AAEA,QAAIsH,YAAJ,EAAkB;AACjB,UAAIA,YAAY,CAAC/D,QAAjB,EAA2B;AAC1B,YAAI,KAAKtB,kBAAT,EAA6B;AAC5B;AACA;;AAED,aAAKjC,UAAL,GAAkB,OAAlB;AACA,aAAKe,yBAAL,GAAiC,IAAjC;;AACA,aAAKqD,gBAAL,CAAsBL,aAAtB,EAAqC,MAAM;AAC1C,eAAKhD,yBAAL,GAAiC,KAAjC;AACA,SAFD;AAGA,OAVD,MAUO;AACNuG,QAAAA,YAAY,CAAC/D,QAAb,GAAwB,IAAxB;AACA,aAAK9D,KAAL,GAAa,EAAb;AACA,aAAKqF,mBAAL;AACA;;AAED,WAAKjC,eAAL,CAAqBwB,KAArB;AACA;AACD;;AAEDD,EAAAA,gBAAgB,CAACpE,UAAD,EAAawH,QAAb,EAAuB;AACtC,SAAKvF,kBAAL,GAA0B4D,UAAU,CAAC,MAAM;AAC1C,WAAK7F,UAAL,GAAkBA,UAAlB;AACA,WAAKiC,kBAAL,GAA0B,IAA1B;AAEAuF,MAAAA,QAAQ,IAAIA,QAAQ,EAApB;AACA,KALmC,EAKjC,IALiC,CAApC;AAMA;;AAEDC,EAAAA,mBAAmB,CAACvE,KAAD,EAAQ;AAC1B,QAAIrG,OAAO,CAACqG,KAAD,CAAX,EAAoB;AACnB,YAAMwE,cAAc,GAAG,KAAK1C,UAAL,CAAgBC,MAAhB,CAAuBd,MAAvB,GAAgC,CAAvD;;AAEA,UAAI,KAAKa,UAAL,CAAgBC,MAAhB,CAAuByC,cAAvB,MAA2CC,QAAQ,CAACC,aAAT,CAAuBlE,UAAvB,CAAkCkE,aAAjF,EAAgG;AAC/F/B,QAAAA,UAAU,CAAC,MAAM;AAChB,eAAKnC,UAAL,CAAgBC,aAAhB,CAA8B,OAA9B,EAAuCmC,KAAvC;AACA,SAFS,EAEP,CAFO,CAAV;AAGA;AACD;AACD;;AAEDhC,EAAAA,YAAY,CAAC+D,GAAD,EAAM;AACjB,WAAO,CAAChK,OAAO,CAAC,KAAKuC,MAAN,CAAP,IAAwBvC,OAAO,CAACiK,iBAAjC,EAAoDD,GAApD,EAAyD,KAAKzG,KAA9D,CAAP;AACA;;AAED2G,EAAAA,gBAAgB,GAAG;AAClB,SAAKC,OAAL;;AAEA,QAAI,CAAC9K,OAAO,EAAZ,EAAgB;AACf,WAAK+K,WAAL,CAAiBnC,KAAjB;AACA,KAFD,MAEO;AACN,WAAKjD,eAAL,CAAqBiD,KAArB;AACA;AACD;;AAEDkC,EAAAA,OAAO,GAAG;AACT,SAAK3H,IAAL,GAAY,CAAC,KAAKA,IAAlB;AACA,SAAKsC,SAAL,CAAe,aAAf;AACA;;AAEDuF,EAAAA,iBAAiB,GAAG;AACnB;AACA,SAAKrG,cAAL,GAAsB,KAAKT,KAAL,CAAWhB,MAAX,CAAkBkD,IAAI,IAAIA,IAAI,CAACC,QAA/B,CAAtB;AACA,WAAO,KAAK1B,cAAZ;AACA;;AAEDsG,EAAAA,oBAAoB,CAACjF,KAAD,EAAQ;AAC3B;AACA,SAAKkF,SAAL,CAAelF,KAAK,CAACC,MAAN,CAAa/B,KAA5B,EAF2B,CAI3B;;AACA,QAAI,CAAClE,OAAO,EAAZ,EAAgB;AACf,WAAK4H,mBAAL;AACA;;AAED,QAAI,CAAC5B,KAAK,CAAC/B,MAAN,CAAakH,yBAAd,IAA2C,CAAC1L,OAAO,CAACuG,KAAK,CAAC/B,MAAP,CAAvD,EAAuE;AACtE,WAAK0B,eAAL,CAAqBwB,KAArB;AACA,WAAK5E,KAAL,GAAa,EAAb,CAFsE,CAItE;;AACA,UAAIvC,OAAO,EAAX,EAAe;AACd,aAAK4H,mBAAL;AACA;;AAED,WAAKnC,SAAL,CAAe,OAAf;AACA;AACD;;AAEDyF,EAAAA,SAAS,CAACE,SAAD,EAAY;AACpBA,IAAAA,SAAS,CAAC3C,OAAV,CAAkBrC,IAAI,IAAI;AACzB,WAAKlC,KAAL,CAAWuE,OAAX,CAAmB4C,OAAO,IAAI;AAC7B,YAAIA,OAAO,CAAC3D,GAAR,KAAgBtB,IAAI,CAACuB,YAAL,CAAkB,mBAAlB,CAApB,EAA4D;AAC3D0D,UAAAA,OAAO,CAAChF,QAAR,GAAmBD,IAAI,CAACC,QAAxB;AACA;AACD,OAJD;AAKA,KAND;AAOA;;AAEDuB,EAAAA,mBAAmB,GAAG;AACrB,SAAKnC,SAAL,CAAe,kBAAf,EAAmC;AAAEvB,MAAAA,KAAK,EAAE,KAAK8G,iBAAL;AAAT,KAAnC,EADqB,CAErB;;AACA,SAAKvF,SAAL,CAAe,eAAf;AACA;;AAEoB,QAAf6F,eAAe,GAAG;AACvB,UAAMC,cAAc,GAAG,MAAM,KAAKC,uBAAL,EAA7B;AACA,SAAK7F,eAAL,GAAuB4F,cAAc,CAAC9E,aAAf,CAA8B,kDAA9B,CAAvB;AACA;;AAEa,QAARgF,QAAQ,GAAG;AAChB,UAAMF,cAAc,GAAG,MAAM,KAAKC,uBAAL,EAA7B;AACA,SAAK/B,IAAL,GAAY8B,cAAc,CAAC9E,aAAf,CAA6B,oCAA7B,CAAZ;AACA;;AAEDiF,EAAAA,MAAM,CAAC1F,KAAD,EAAQ;AACb,QAAIhG,OAAO,MAAM,CAAC,KAAKgD,QAAnB,IAA+B,CAAC,KAAK8C,gBAArC,IAAyD,CAAC,KAAKhB,SAAnE,EAA8E;AAC7E,WAAKa,eAAL,CAAqByB,MAArB,CAA4B,IAA5B;AACA;;AAED,SAAKtB,gBAAL,GAAwB,KAAxB;AACA;;AAED6F,EAAAA,iBAAiB,GAAG;AACnB;AACA,QAAI3L,OAAO,EAAX,EAAe;AACd,WAAK4L,IAAL;AACA;;AAED,SAAKd,OAAL;;AAEA,SAAKrH,YAAL,GAAoB,KAApB;AACA,SAAKH,cAAL,GAAsB,KAAtB;AACA;;AAEDuI,EAAAA,WAAW,GAAG;AACb,SAAKC,gBAAL,GAAwB,KAAK5H,KAAL,CAAW6H,GAAX,CAAe3F,IAAI,IAAI;AAC9C,aAAO;AACNmB,QAAAA,GAAG,EAAEnB,IADC;AAENC,QAAAA,QAAQ,EAAED,IAAI,CAACC;AAFT,OAAP;AAIA,KALuB,CAAxB;AAOA,SAAKxB,gBAAL,GAAwB,KAAKtC,KAA7B;;AAEA,QAAI,KAAKe,cAAT,EAAyB;AACxB,WAAK6C,aAAL,GAAqB,KAAK/C,cAAL,CAAoBF,MAApB,CAA2BkD,IAAI,IAAIA,IAAI,CAACC,QAAxC,CAArB;AACA;AACD;;AAED2F,EAAAA,iBAAiB,GAAG;AACnB,UAAMhI,KAAK,GAAG,KAAKwC,UAAL,CAAgBC,aAAhB,CAA8B,OAA9B,CAAd;AACA,SAAK7B,eAAL,GAAuB,KAAKrC,KAA5B;;AAEA,QAAIyB,KAAK,IAAI,CAACA,KAAK,CAACzB,KAApB,EAA2B;AAC1B,WAAKa,cAAL,GAAsB,KAAKc,KAA3B;AACA;;AAED,SAAKA,KAAL,CAAWuE,OAAX,CAAmBrC,IAAI,IAAI;AAC1BA,MAAAA,IAAI,CAAC6F,cAAL,GAAsB,MAAM,KAAKtG,eAAL,CAAqBc,aAArB,CAAoC,qBAAoBL,IAAI,CAAC8F,YAAa,GAA1E,CAA5B;AACA,KAFD;;AAIA,UAAMvF,aAAa,GAAG,KAAKC,YAAL,CAAkB,KAAKrE,KAAvB,CAAtB;;AACA,SAAKa,cAAL,GAAsBuD,aAAtB;AACA;;AAEqB,QAAhBwF,gBAAgB,GAAG;AACxB,UAAM,KAAKb,eAAL,EAAN;AACA,UAAM,KAAKG,QAAL,EAAN;AAEA,SAAK7F,MAAL,CAAY,KAAKwG,kCAAjB;AACA,SAAKC,2BAAL;AAEA,SAAKvH,SAAL,GAAiB,KAAjB;AACA;;AAEW,MAARwH,QAAQ,GAAG;AACd,WAAOtM,OAAO,EAAd;AACA;;AAEDuM,EAAAA,gBAAgB,GAAG;AAClB,SAAK9I,YAAL,GAAoB,IAApB;AACA;;AAED4I,EAAAA,2BAA2B,GAAG;AAC7B,QAAI,KAAKlJ,IAAL,IAAa,CAAC,KAAKS,UAAvB,EAAmC;AAClC,WAAKA,UAAL,GAAkB,KAAK6F,IAAL,CAAUlE,WAA5B;AACA;AACD;;AAEDK,EAAAA,MAAM,CAAC4G,SAAD,EAAY;AACjB,QAAIA,SAAS,IAAI,CAAC,KAAKrJ,IAAvB,EAA6B;AAC5B,WAAKsJ,WAAL;AACA,KAFD,MAEO;AACN,WAAKC,YAAL;AACA;AACD;;AAEDC,EAAAA,YAAY,GAAG;AACd,SAAKb,gBAAL,CAAsBrD,OAAtB,CAA8BrC,IAAI,IAAI;AACrCA,MAAAA,IAAI,CAACmB,GAAL,CAASlB,QAAT,GAAoBD,IAAI,CAACC,QAAzB;AACA,KAFD;;AAIA,SAAKX,aAAL;AAEA,SAAKnD,KAAL,GAAa,KAAKsC,gBAAlB;AACA;;AAED+H,EAAAA,QAAQ,GAAG;AACV,QAAI5M,OAAO,EAAX,EAAe;AACd,WAAK4H,mBAAL;AACA;;AAED,SAAKlC,aAAL;AACA;;AAEgB,QAAX+G,WAAW,GAAG;AACnB,UAAMI,OAAO,GAAG,MAAM,KAAKC,WAAL,EAAtB;;AAEA,QAAID,OAAJ,EAAa;AACZA,MAAAA,OAAO,CAACzF,MAAR,CAAe,IAAf;AACA;AACD;;AAED2F,EAAAA,oBAAoB,GAAG;AACtB,SAAKhC,WAAL,CAAiBnC,KAAjB;AACA;;AAEiB,QAAZ8D,YAAY,GAAG;AACpB,UAAMG,OAAO,GAAG,MAAM,KAAKC,WAAL,EAAtB;AAEAD,IAAAA,OAAO,IAAIA,OAAO,CAAC1F,KAAR,EAAX;AACA;;AAEgB,QAAX2F,WAAW,GAAG;AACnB,UAAMvB,cAAc,GAAG,MAAM,KAAKC,uBAAL,EAA7B;AACA,WAAOD,cAAc,CAAC9E,aAAf,CAA6B,eAA7B,CAAP;AACA;;AAE0B,QAArBuG,qBAAqB,GAAG;AAC7B,UAAMzB,cAAc,GAAG,MAAM,KAAKC,uBAAL,EAA7B;AACA,WAAOD,cAAc,CAAC9E,aAAf,CAA6B,0BAA7B,CAAP;AACA;;AAEyB,QAApBqD,oBAAoB,GAAG;AAC5B,UAAMmD,iBAAiB,GAAG,MAAM,KAAKD,qBAAL,EAAhC;AACA,SAAKtD,gBAAL,GAAwBuD,iBAAiB,CAACxG,aAAlB,CAAgC,8DAAhC,CAAxB;AACA;;AAEa,MAAVqB,UAAU,GAAG;AAChB,WAAO,KAAKtB,UAAL,CAAgBC,aAAhB,CAA8B,iBAA9B,CAAP;AACA;;AAEDyG,EAAAA,YAAY,GAAG;AACd,QAAI,CAAClN,OAAO,EAAR,IAAc,KAAKgD,QAAvB,EAAiC;AAChC,WAAKO,OAAL,GAAe,IAAf;AACA,KAFD,MAEO;AACN,WAAKwH,WAAL,CAAiBa,IAAjB;AACA;;AAED,SAAK3C,UAAL,GAAkB,KAAK1G,KAAvB;AACA;;AAED4K,EAAAA,aAAa,CAACnH,KAAD,EAAQ;AACpB,QAAI,CAAC,KAAKQ,UAAL,CAAgB4G,QAAhB,CAAyBpH,KAAK,CAACuC,aAA/B,CAAD,IAAkD,CAAC,KAAKzD,SAA5D,EAAuE;AACtE,WAAKvB,OAAL,GAAe,KAAf,CADsE,CAGtE;;AACA,UAAI,CAACvD,OAAO,EAAR,IAAc,CAAC,KAAK2C,iBAApB,IAA0C,KAAK4I,cAAL,KAAwBvF,KAAK,CAACuC,aAA5E,EAA4F;AAC3F,aAAKhG,KAAL,GAAa,EAAb;AACA;AACD;AACD;;AAED8K,EAAAA,kBAAkB,GAAG;AACpB,SAAK9G,SAAL,CAAeqC,KAAf;AACA;;AAEW,MAAR0E,QAAQ,GAAG;AACd,WAAO,CAAC,KAAKtK,QAAb;AACA;;AAEiB,MAAduK,cAAc,GAAG;AACpB,WAAO,CAACvN,OAAO,EAAR,KAAe,KAAKuD,OAAL,IAAgB,KAAKC,iBAApC,CAAP;AACA;;AAEwB,MAArBgK,qBAAqB,GAAG;AAC3B,WAAO,KAAKxK,QAAL,GAAgB,MAAhB,GAAyB,aAAhC;AACA;;AAEiB,MAAdyK,cAAc,GAAG;AACpB,WAAO,KAAKzK,QAAL,GAAgB,UAAhB,GAA6B,QAApC;AACA;;AAEgB,MAAb0K,aAAa,GAAG;AACnB,WAAO,KAAK5K,UAAL,KAAoB1D,UAAU,CAAC2D,IAAtC;AACA;;AAEuB,MAApB8G,oBAAoB,GAAG;AAC1B,WAAO,KAAK6D,aAAL,IAAsB,KAAK5K,UAAL,KAAoB1D,UAAU,CAACuO,OAA5D;AACA;;AAEiB,MAAdC,cAAc,GAAG;AACpB,QAAIC,GAAG,GAAG,KAAK/K,UAAf;;AAEA,QAAI,KAAKe,yBAAT,EAAoC;AACnCgK,MAAAA,GAAG,GAAG,iBAAN;AACA;;AAED,WAAO,KAAKC,sBAAL,CAA4BD,GAA5B,CAAP;AACA;;AAEmB,MAAhBE,gBAAgB,GAAG;AACtB,WAAO,KAAKL,aAAL,GAAsB,GAAE,KAAKhG,GAAI,iBAAjC,GAAoDsG,SAA3D;AACA;;AAEwB,MAArBC,qBAAqB,GAAG;AAC3B,WAAO,KAAKC,eAAL,CAAqB,mBAArB,EAA0CnC,GAA1C,CAA8CoC,EAAE,IAAIA,EAAE,CAACC,SAAH,CAAa,IAAb,CAApD,CAAP;AACA;AAED;AACD;AACA;;;AAC4B,MAAtBC,sBAAsB,GAAG;AAC7B,UAAMC,iBAAiB,GAAG;AACzBC,MAAAA,KAAK,EAAE,OADkB;AAEzBC,MAAAA,OAAO,EAAE,OAFgB;AAGzBb,MAAAA,OAAO,EAAE,aAHgB;AAIzBc,MAAAA,WAAW,EAAE;AAJY,KAA1B;AAOA,WAAO,KAAK3L,UAAL,KAAoB1D,UAAU,CAAC2D,IAA/B,GAAsCuL,iBAAiB,CAAC,KAAKxL,UAAN,CAAvD,GAA2E,EAAlF;AACA;;AAEmB,MAAhB4L,gBAAgB,GAAG;AACtB,QAAI,CAAC,KAAK5G,UAAV,EAAsB;AACrB;AACA;;AACD,WAAO,KAAKA,UAAL,CAAgB4G,gBAAhB,EAAP;AACA;;AAEqB,MAAlBC,kBAAkB,GAAG;AACxB,WAAQ,GAAE,KAAKjH,GAAI,mBAAnB;AACA;;AAEsB,MAAnBkH,mBAAmB,GAAG;AACzB,WAAO,KAAKb,gBAAL,GAAyB,GAAE,KAAKY,kBAAmB,IAAG,KAAKZ,gBAAiB,EAA5E,GAAiF,GAAE,KAAKY,kBAAmB,EAAlH;AACA;;AAEwC,MAArCE,qCAAqC,GAAG;AAC3C,WAAO,CAAC,KAAKxM,iBAAL,CAAuB4E,MAAxB,IAAkC,KAAK4C,oBAA9C;AACA;;AAEqC,MAAlCuC,kCAAkC,GAAG;AACxC,WAAO,KAAK7I,OAAL,IAAgB,CAAC,KAAKP,QAAtB,IAAkC,KAAK6G,oBAAvC,IAA+D,CAAC,KAAKpG,YAA5E;AACA;;AAEyB,MAAtBqK,sBAAsB,GAAG;AAC5B,WAAO;AACN,iBAAW1J,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiClO,mBAAjC,CADL;AAEN,eAASuD,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiCjO,iBAAjC,CAFH;AAGN,yBAAmBsD,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiC3N,kCAAjC,CAHb;AAIN,iBAAWgD,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiChO,mBAAjC,CAJL;AAKN,qBAAeqD,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiC/N,uBAAjC;AALT,KAAP;AAOA;;AAEc,MAAX+J,WAAW,GAAG;AACjB,QAAI/K,OAAO,EAAX,EAAe;AACd,UAAI,KAAK2F,eAAL,CAAqBiE,MAAzB,EAAiC;AAChC,eAAO,KAAKjE,eAAL,CAAqBc,aAArB,CAAmC,OAAnC,CAAP;AACA;AACD;;AAED,WAAO,KAAKyB,SAAL,GAAiBzB,aAAjB,CAA+B,2BAA/B,CAAP;AACA;;AAEmB,MAAhBuI,gBAAgB,GAAG;AACtB,WAAO5K,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiC9N,uBAAjC,CAAP;AACA;;AAE0B,MAAvBgO,uBAAuB,GAAG;AAC7B,WAAO7K,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiC7N,cAAjC,CAAP;AACA;;AAEkB,MAAfgO,eAAe,GAAG;AACrB,WAAO9K,aAAa,CAAC0K,UAAd,CAAyBC,OAAzB,CAAiC5N,8BAAjC,CAAP;AACA;;AAEqB,MAAlBgO,kBAAkB,GAAG;AACxB,WAAO,CAAC,KAAK5B,cAAL,IAAuB,KAAKpK,IAA7B,KAAsC,CAAC,KAAKH,QAAnD;AACA;;AAEoC,MAAjCoM,iCAAiC,GAAG;AACvC,WAAO,KAAKC,YAAL,KAAsB,KAAtB,GAA8B,MAA9B,GAAuC,OAA9C;AACA;;AAEU,MAAPC,OAAO,GAAG;AACb,WAAO;AACNzC,MAAAA,OAAO,EAAE;AACR,2DAAmD,IAD3C;AAER,mCAA2B,CAAC,KAAK7M,OAFzB;AAGR,2DAAmD,CAAC,KAAKA,OAAN,IAAiB,KAAK6J;AAHjE,OADH;AAMN0F,MAAAA,iBAAiB,EAAE;AAClB,sCAA8B,IADZ;AAElB,wCAAgC,IAFd;AAGlB,0CAAkC,KAAKzM,UAAL,KAAoB1D,UAAU,CAACuO,OAH/C;AAIlB,wCAAgC,KAAK7K,UAAL,KAAoB1D,UAAU,CAACmP,KAJ7C;AAKlB,0CAAkC,KAAKzL,UAAL,KAAoB1D,UAAU,CAACoP,OAL/C;AAMlB,8CAAsC,KAAK1L,UAAL,KAAoB1D,UAAU,CAACqP;AANnD;AANb,KAAP;AAeA;;AAES,MAANlN,MAAM,GAAG;AACZ,WAAO;AACNiO,MAAAA,wBAAwB,EAAE;AACzB,iBAAU,GAAE,KAAK5L,UAAW,IADH;AAEzB,mBAAW,KAAKA,UAAL,KAAoB,CAApB,GAAwB,MAAxB,GAAiC;AAFnB,OADpB;AAKN6L,MAAAA,aAAa,EAAE;AACd,qBAAazP,OAAO,KAAK,MAAL,GAAe,GAAE,KAAK2D,WAAY;AADxC;AALT,KAAP;AASA;;AAEoB,eAAR+L,QAAQ,GAAG;AACvBtL,IAAAA,aAAa,CAAC0K,UAAd,GAA2B,MAAM7O,aAAa,CAAC,oBAAD,CAA9C;AACA;;AAptBqC;;AAutBvCmE,aAAa,CAACuL,MAAd;AAEA,eAAevL,aAAf","sourcesContent":["import UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport litRender from \"@ui5/webcomponents-base/dist/renderer/LitRenderer.js\";\nimport ResizeHandler from \"@ui5/webcomponents-base/dist/delegate/ResizeHandler.js\";\nimport ValueState from \"@ui5/webcomponents-base/dist/types/ValueState.js\";\nimport {\n\tisShow,\n\tisDown,\n\tisUp,\n\tisBackSpace,\n\tisSpace,\n\tisLeft,\n\tisRight,\n\tisEscape,\n\tisEnter,\n} from \"@ui5/webcomponents-base/dist/Keys.js\";\nimport Integer from \"@ui5/webcomponents-base/dist/types/Integer.js\";\nimport \"@ui5/webcomponents-icons/dist/slim-arrow-down.js\";\nimport { isIE, isPhone } from \"@ui5/webcomponents-base/dist/Device.js\";\nimport { getI18nBundle } from \"@ui5/webcomponents-base/dist/i18nBundle.js\";\nimport \"@ui5/webcomponents-icons/dist/decline.js\";\nimport \"@ui5/webcomponents-icons/dist/multiselect-all.js\";\nimport \"@ui5/webcomponents-icons/dist/not-editable.js\";\nimport MultiComboBoxItem from \"./MultiComboBoxItem.js\";\nimport Tokenizer from \"./Tokenizer.js\";\nimport Token from \"./Token.js\";\nimport Icon from \"./Icon.js\";\nimport Popover from \"./Popover.js\";\nimport ResponsivePopover from \"./ResponsivePopover.js\";\nimport List from \"./List.js\";\nimport StandardListItem from \"./StandardListItem.js\";\nimport ToggleButton from \"./ToggleButton.js\";\nimport * as Filters from \"./ComboBoxFilters.js\";\nimport Button from \"./Button.js\";\n\nimport {\n\tVALUE_STATE_SUCCESS,\n\tVALUE_STATE_ERROR,\n\tVALUE_STATE_WARNING,\n\tVALUE_STATE_INFORMATION,\n\tINPUT_SUGGESTIONS_TITLE,\n\tSELECT_OPTIONS,\n\tMULTICOMBOBOX_DIALOG_OK_BUTTON,\n\tVALUE_STATE_ERROR_ALREADY_SELECTED,\n} from \"./generated/i18n/i18n-defaults.js\";\n\n// Templates\nimport MultiComboBoxTemplate from \"./generated/templates/MultiComboBoxTemplate.lit.js\";\nimport MultiComboBoxPopoverTemplate from \"./generated/templates/MultiComboBoxPopoverTemplate.lit.js\";\n\n// Styles\nimport styles from \"./generated/themes/MultiComboBox.css.js\";\nimport ResponsivePopoverCommonCss from \"./generated/themes/ResponsivePopoverCommon.css.js\";\nimport ValueStateMessageCss from \"./generated/themes/ValueStateMessage.css.js\";\nimport SuggestionsCss from \"./generated/themes/Suggestions.css.js\";\n\n/**\n * @public\n */\nconst metadata = {\n\ttag: \"ui5-multi-combobox\",\n\tlanguageAware: true,\n\tmanagedSlots: true,\n\tslots: /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */ {\n\t\t/**\n\t\t * Defines the component items.\n\t\t *\n\t\t * @type {sap.ui.webcomponents.main.IMultiComboBoxItem[]}\n\t\t * @slot items\n\t\t * @public\n\t\t */\n\t\t\"default\": {\n\t\t\tpropertyName: \"items\",\n\t\t\ttype: HTMLElement,\n\t\t\tinvalidateOnChildChange: true,\n\t\t},\n\n\t\t/**\n\t\t* Defines the icon to be displayed in the component.\n\t\t*\n\t\t* @type {sap.ui.webcomponents.main.IIcon}\n\t\t* @slot\n\t\t* @public\n\t\t* @since 1.0.0-rc.9\n\t\t*/\n\t\ticon: {\n\t\t\ttype: HTMLElement,\n\t\t},\n\n\t\t/**\n\t\t * Defines the value state message that will be displayed as pop up under the component.\n\t\t * <br><br>\n\t\t *\n\t\t * <b>Note:</b> If not specified, a default text (in the respective language) will be displayed.\n\t\t * <br>\n\t\t * <b>Note:</b> The <code>valueStateMessage</code> would be displayed,\n\t\t * when the component is in <code>Information</code>, <code>Warning</code> or <code>Error</code> value state.\n\t\t * @type {HTMLElement[]}\n\t\t * @since 1.0.0-rc.9\n\t\t * @slot\n\t\t * @public\n\t\t */\n\t\tvalueStateMessage: {\n\t\t\ttype: HTMLElement,\n\t\t},\n\t},\n\tproperties: /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */ {\n\t\t/**\n\t\t * Defines the value of the component.\n\t\t * <br><br>\n\t\t * <b>Note:</b> The property is updated upon typing.\n\t\t *\n\t\t * @type {string}\n\t\t * @defaultvalue \"\"\n\t\t * @public\n\t\t */\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefaultValue: \"\",\n\t\t},\n\n\t\t/**\n\t\t * Defines a short hint intended to aid the user with data entry when the\n\t\t * component has no value.\n\t\t * @type {string}\n\t\t * @defaultvalue \"\"\n\t\t * @public\n\t\t */\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\tdefaultValue: \"\",\n\t\t},\n\n\t\t/**\n\t\t * Defines if the user input will be prevented, if no matching item has been found\n\t\t *\n\t\t * @type {boolean}\n\t\t * @defaultvalue false\n\t\t * @public\n\t\t */\n\t\tallowCustomValues: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t/**\n\t\t * Defines whether the component is in disabled state.\n\t\t * <br><br>\n\t\t * <b>Note:</b> A disabled component is completely noninteractive.\n\t\t *\n\t\t * @type {boolean}\n\t\t * @defaultvalue false\n\t\t * @public\n\t\t */\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t/**\n\t\t * Defines the value state of the component.\n\t\t * <br><br>\n\t\t * Available options are:\n\t\t * <ul>\n\t\t * <li><code>None</code></li>\n\t\t * <li><code>Error</code></li>\n\t\t * <li><code>Warning</code></li>\n\t\t * <li><code>Success</code></li>\n\t\t * <li><code>Information</code></li>\n\t\t * </ul>\n\t\t *\n\t\t * @type {ValueState}\n\t\t * @defaultvalue \"None\"\n\t\t * @public\n\t\t */\n\t\tvalueState: {\n\t\t\ttype: ValueState,\n\t\t\tdefaultValue: ValueState.None,\n\t\t},\n\n\t\t/**\n\t\t * Defines whether the component is read-only.\n\t\t * <br><br>\n\t\t * <b>Note:</b> A read-only component is not editable,\n\t\t * but still provides visual feedback upon user interaction.\n\t\t *\n\t\t * @type {boolean}\n\t\t * @defaultvalue false\n\t\t * @public\n\t\t */\n\t\treadonly: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t/**\n\t\t * Defines whether the component is required.\n\t\t *\n\t\t * @type {boolean}\n\t\t * @defaultvalue false\n\t\t * @public\n\t\t * @since 1.0.0-rc.5\n\t\t */\n\t\trequired: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t/**\n\t\t * Defines the filter type of the component.\n\t\t * Available options are: <code>StartsWithPerTerm</code>, <code>StartsWith</code>, <code>Contains</code> and <code>None</code>.\n\t\t *\n\t\t * @type {string}\n\t\t * @defaultvalue \"StartsWithPerTerm\"\n\t\t * @public\n\t\t */\n\t\tfilter: {\n\t\t\ttype: String,\n\t\t\tdefaultValue: \"StartsWithPerTerm\",\n\t\t},\n\n\t\t/**\n\t\t * Indicates whether the dropdown is open. True if the dropdown is open, false otherwise.\n\t\t *\n\t\t * @type {boolean}\n\t\t * @defaultvalue false\n\t\t * @readonly\n\t\t * @since 1.0.0-rc.5\n\t\t * @public\n\t\t */\n\t\topen: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t_filteredItems: {\n\t\t\ttype: Object,\n\t\t},\n\n\t\tfilterSelected: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\tfocused: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t_tokenizerFocused: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t_iconPressed: {\n\t\t\ttype: Boolean,\n\t\t\tnoAttribute: true,\n\t\t},\n\n\t\t_inputWidth: {\n\t\t\ttype: Integer,\n\t\t\tnoAttribute: true,\n\t\t},\n\n\t\t_listWidth: {\n\t\t\ttype: Integer,\n\t\t\tdefaultValue: 0,\n\t\t\tnoAttribute: true,\n\t\t},\n\n\t\t_performingSelectionTwice: {\n\t\t\ttype: Boolean,\n\t\t},\n\t},\n\tevents: /** @lends sap.ui.webcomponents.main.MultiComboBox.prototype */ {\n\t\t/**\n\t\t * Fired when the input operation has finished by pressing Enter or on focusout.\n\t\t *\n\t\t * @event\n\t\t * @public\n\t\t */\n\t\tchange: {},\n\n\t\t/**\n\t\t * Fired when the value of the component changes at each keystroke.\n\t\t *\n\t\t * @event\n\t\t * @public\n\t\t */\n\t\tinput: {},\n\n\t\t/**\n\t\t * Fired when the dropdown is opened or closed.\n\t\t *\n\t\t * @event sap.ui.webcomponents.main.MultiComboBox#open-change\n\t\t * @since 1.0.0-rc.5\n\t\t * @public\n\t\t */\n\t\t\"open-change\": {},\n\n\t\t/**\n\t\t * Fired when selection is changed by user interaction\n\t\t * in <code>SingleSelect</code> and <code>MultiSelect</code> modes.\n\t\t *\n\t\t * @event sap.ui.webcomponents.main.MultiComboBox#selection-change\n\t\t * @param {Array} items an array of the selected items.\n\t\t * @public\n\t\t */\n\t\t\"selection-change\": {\n\t\t\tdetail: {\n\t\t\t\titems: { type: Array },\n\t\t\t},\n\t\t},\n\t},\n};\n\n/**\n * @class\n *\n * <h3 class=\"comment-api-title\">Overview</h3>\n *\n * The <code>ui5-multi-combobox</code> component consists of a list box with items and a text field allowing the user to either type a value directly into the text field, or choose from the list of existing items.\n *\n * The drop-down list is used for selecting and filtering values, it enables users to select one or more options from a predefined list. The control provides an editable input field to filter the list, and a dropdown arrow to expand/collapse the list of available options.\n * The options in the list have checkboxes that permit multi-selection. Entered values are displayed as tokens.\n * <h3>Structure</h3>\n * The <code>ui5-multi-combobox</code> consists of the following elements:\n * <ul>\n * <li> Tokenizer - a list of tokens with selected options.\n * <li> Input field - displays the selected option/s as token/s. Users can type to filter the list.\n * <li> Drop-down arrow - expands\\collapses the option list.</li>\n * <li> Option list - the list of available options.</li>\n * </ul>\n * <h3>Keyboard Handling</h3>\n *\n * The <code>ui5-multi-combobox</code> provides advanced keyboard handling.\n *\n * <h4>Picker</h4>\n * If the <code>ui5-multi-combobox</code> is focused,\n * you can open or close the drop-down by pressing <code>F4</code>, <code>ALT+UP</code> or <code>ALT+DOWN</code> keys.\n * Once the drop-down is opened, you can use the <code>UP</code> and <code>DOWN</code> arrow keys\n * to navigate through the available options and select one by pressing the <code>Space</code> or <code>Enter</code> keys.\n * <br>\n *\n * <h4>Tokens</h4>\n * <ul>\n * <li> Left/Right arrow keys - moves the focus selection form the currently focused token to the previous/next one (if available). </li>\n * <li> Delete -  deletes the token and focuses the previous token. </li>\n * <li> Backspace -  deletes the token and focus the next token. </li>\n * </ul>\n *\n * <h3>CSS Shadow Parts</h3>\n *\n * <ui5-link target=\"_blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/::part\">CSS Shadow Parts</ui5-link> allow developers to style elements inside the Shadow DOM.\n * <br>\n * The <code>ui5-multi-combobox</code> exposes the following CSS Shadow Parts:\n * <ul>\n * <li>token-{index} - Used to style each token(where <code>token-0</code> corresponds to the first item)</li>\n * </ul>\n *\n * <h3>ES6 Module Import</h3>\n *\n * <code>import \"@ui5/webcomponents/dist/MultiComboBox\";</code>\n *\n *\n * @constructor\n * @author SAP SE\n * @alias sap.ui.webcomponents.main.MultiComboBox\n * @extends UI5Element\n * @tagname ui5-multi-combobox\n * @public\n * @appenddocs MultiComboBoxItem\n * @since 0.11.0\n */\nclass MultiComboBox extends UI5Element {\n\tstatic get metadata() {\n\t\treturn metadata;\n\t}\n\n\tstatic get render() {\n\t\treturn litRender;\n\t}\n\n\tstatic get template() {\n\t\treturn MultiComboBoxTemplate;\n\t}\n\n\tstatic get staticAreaTemplate() {\n\t\treturn MultiComboBoxPopoverTemplate;\n\t}\n\n\tstatic get styles() {\n\t\treturn styles;\n\t}\n\n\tstatic get staticAreaStyles() {\n\t\treturn [ResponsivePopoverCommonCss, ValueStateMessageCss, SuggestionsCss];\n\t}\n\n\tstatic get dependencies() {\n\t\treturn [\n\t\t\tMultiComboBoxItem,\n\t\t\tTokenizer,\n\t\t\tToken,\n\t\t\tIcon,\n\t\t\tResponsivePopover,\n\t\t\tPopover,\n\t\t\tList,\n\t\t\tStandardListItem,\n\t\t\tToggleButton,\n\t\t\tButton,\n\t\t];\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._filteredItems = [];\n\t\tthis.selectedValues = [];\n\t\tthis._inputLastValue = \"\";\n\t\tthis._valueBeforeOpen = \"\";\n\t\tthis._deleting = false;\n\t\tthis._validationTimeout = null;\n\t\tthis._handleResizeBound = this._handleResize.bind(this);\n\t}\n\n\tonEnterDOM() {\n\t\tResizeHandler.register(this, this._handleResizeBound);\n\t}\n\n\tonExitDOM() {\n\t\tResizeHandler.deregister(this, this._handleResizeBound);\n\t}\n\n\t_handleResize() {\n\t\tthis._inputWidth = this.offsetWidth;\n\t}\n\n\t_inputChange() {\n\t\tthis.fireEvent(\"change\");\n\t}\n\n\ttogglePopover() {\n\t\tthis.allItemsPopover.toggle(this);\n\t}\n\n\t_showFilteredItems() {\n\t\tthis.filterSelected = true;\n\t\tthis._showMorePressed = true;\n\n\t\tthis.togglePopover();\n\t}\n\n\tfilterSelectedItems(event) {\n\t\tthis.filterSelected = event.target.pressed;\n\t\tthis.selectedItems = this._filteredItems.filter(item => item.selected);\n\t}\n\n\tget _showAllItemsButtonPressed() {\n\t\treturn this.filterSelected;\n\t}\n\n\tget _inputDom() {\n\t\treturn this.shadowRoot.querySelector(\"#ui5-multi-combobox-input\");\n\t}\n\n\t_inputLiveChange(event) {\n\t\tconst input = event.target;\n\t\tconst value = input.value;\n\t\tconst filteredItems = this._filterItems(value);\n\t\tconst oldValueState = this.valueState;\n\n\t\tif (this.filterSelected) {\n\t\t\tthis.filterSelected = false;\n\t\t}\n\n\t\t/* skip calling change event when an input with a placeholder is focused on IE\n\t\t\t- value of the host and the internal input should be differnt in case of actual input\n\t\t\t- input is called when a key is pressed => keyup should not be called yet\n\t\t*/\n\t\tconst skipFiring = (this._inputDom.value === this.value) && isIE() && !this._keyDown && !!this.placeholder;\n\n\t\tif (skipFiring) {\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._validationTimeout) {\n\t\t\tinput.value = this._inputLastValue;\n\t\t\treturn;\n\t\t}\n\n\t\tif (!filteredItems.length && value && !this.allowCustomValues) {\n\t\t\tinput.value = this._inputLastValue;\n\t\t\tthis.valueState = \"Error\";\n\n\t\t\tthis._resetValueState(oldValueState);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._inputLastValue = input.value;\n\t\tthis.value = input.value;\n\t\tthis._filteredItems = filteredItems;\n\n\t\tif (!isPhone()) {\n\t\t\tif (filteredItems.length === 0) {\n\t\t\t\tthis.allItemsPopover.close();\n\t\t\t} else {\n\t\t\t\tthis.allItemsPopover.showAt(this);\n\t\t\t}\n\t\t}\n\n\t\tthis.fireEvent(\"input\");\n\t}\n\n\t_tokenDelete(event) {\n\t\tconst token = event.detail.ref;\n\t\tconst deletingItem = this.items.find(item => item._id === token.getAttribute(\"data-ui5-id\"));\n\n\t\tdeletingItem.selected = false;\n\t\tthis._deleting = true;\n\n\t\tthis.fireSelectionChange();\n\t}\n\n\tget _getPlaceholder() {\n\t\tif (this._tokenizer && this._tokenizer.tokens.length) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\treturn this.placeholder;\n\t}\n\n\t_handleLeft() {\n\t\tconst cursorPosition = this.getDomRef().querySelector(`input`).selectionStart;\n\n\t\tif (cursorPosition === 0) {\n\t\t\tthis._tokenizer._focusLastToken();\n\t\t}\n\t}\n\n\t_tokenizerFocusOut(event) {\n\t\tthis._tokenizerFocused = false;\n\n\t\tconst tokensCount = this._tokenizer.tokens.length - 1;\n\n\t\tif (!event.relatedTarget || !event.relatedTarget.hasAttribute(\"ui5-token\")) {\n\t\t\tthis._tokenizer.tokens.forEach(token => { token.selected = false; });\n\t\t\tthis._tokenizer.scrollToStart();\n\t\t}\n\n\t\tif (tokensCount === 0 && this._deleting) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!isPhone()) {\n\t\t\t\t\tthis.shadowRoot.querySelector(\"input\").focus();\n\t\t\t\t}\n\n\t\t\t\tthis._deleting = false;\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\t_tokenizerFocusIn() {\n\t\tthis._tokenizerFocused = true;\n\t\tthis.focused = false;\n\t}\n\n\t_onkeyup() {\n\t\tthis._keyDown = false;\n\t}\n\n\tasync _onkeydown(event) {\n\t\tif (isLeft(event)) {\n\t\t\tthis._handleLeft(event);\n\t\t}\n\n\t\tif (isShow(event) && !this.readonly && !this.disabled) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.togglePopover();\n\t\t}\n\n\t\tif (this.open && (isUp(event) || isDown(event))) {\n\t\t\tthis._handleArrowNavigation(event);\n\t\t}\n\n\t\tif (isBackSpace(event) && event.target.value === \"\") {\n\t\t\tevent.preventDefault();\n\n\t\t\tthis._tokenizer._focusLastToken();\n\t\t}\n\n\t\t// Reset value on ESC\n\t\tif (isEscape(event) && (!this.allowCustomValues || (!this.open && this.allowCustomValues))) {\n\t\t\tthis.value = this._lastValue;\n\t\t}\n\n\t\tif (isEnter(event)) {\n\t\t\tthis.handleEnter();\n\t\t}\n\n\t\tthis._keyDown = true;\n\t}\n\n\t_onValueStateKeydown(event) {\n\t\tconst isArrowDown = isDown(event);\n\t\tconst isArrowUp = isUp(event);\n\n\t\tevent.preventDefault();\n\n\t\tif (isArrowDown) {\n\t\t\tthis._handleArrowDown(event);\n\t\t}\n\n\t\tif (isArrowUp) {\n\t\t\tthis._inputDom.focus();\n\t\t}\n\t}\n\n\t_onItemKeydown(event) {\n\t\tconst isFirstItem = this.list.items[0] === event.target;\n\n\t\tevent.preventDefault();\n\n\t\tif (!isUp(event) || !isFirstItem) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.valueStateHeader) {\n\t\t\tthis.valueStateHeader.focus();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._inputDom.focus();\n\t}\n\n\tasync _handleArrowNavigation(event) {\n\t\tconst isArrowDown = isDown(event);\n\t\tconst hasSuggestions = this.allItemsPopover.opened && this.items.length;\n\n\t\tevent.preventDefault();\n\n\t\tif (this.hasValueStateMessage && !this.valueStateHeader) {\n\t\t\tawait this._setValueStateHeader();\n\t\t}\n\n\t\tif (isArrowDown && this.focused && this.valueStateHeader) {\n\t\t\tthis.valueStateHeader.focus();\n\t\t\treturn;\n\t\t}\n\n\t\tif (isArrowDown && this.focused && hasSuggestions) {\n\t\t\tthis._handleArrowDown(event);\n\t\t}\n\t}\n\n\t_handleArrowDown(event) {\n\t\tconst firstListItem = this.list.items[0];\n\n\t\tthis.list._itemNavigation.setCurrentItem(firstListItem);\n\t\tfirstListItem.focus();\n\t}\n\n\thandleEnter() {\n\t\tconst lowerCaseValue = this.value.toLowerCase();\n\t\tconst matchingItem = this.items.find(item => item.text.toLowerCase() === lowerCaseValue);\n\t\tconst oldValueState = this.valueState;\n\n\t\tif (matchingItem) {\n\t\t\tif (matchingItem.selected) {\n\t\t\t\tif (this._validationTimeout) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.valueState = \"Error\";\n\t\t\t\tthis._performingSelectionTwice = true;\n\t\t\t\tthis._resetValueState(oldValueState, () => {\n\t\t\t\t\tthis._performingSelectionTwice = false;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tmatchingItem.selected = true;\n\t\t\t\tthis.value = \"\";\n\t\t\t\tthis.fireSelectionChange();\n\t\t\t}\n\n\t\t\tthis.allItemsPopover.close();\n\t\t}\n\t}\n\n\t_resetValueState(valueState, callback) {\n\t\tthis._validationTimeout = setTimeout(() => {\n\t\t\tthis.valueState = valueState;\n\t\t\tthis._validationTimeout = null;\n\n\t\t\tcallback && callback();\n\t\t}, 2000);\n\t}\n\n\t_onTokenizerKeydown(event) {\n\t\tif (isRight(event)) {\n\t\t\tconst lastTokenIndex = this._tokenizer.tokens.length - 1;\n\n\t\t\tif (this._tokenizer.tokens[lastTokenIndex] === document.activeElement.shadowRoot.activeElement) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.shadowRoot.querySelector(\"input\").focus();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\t_filterItems(str) {\n\t\treturn (Filters[this.filter] || Filters.StartsWithPerTerm)(str, this.items);\n\t}\n\n\t_afterOpenPicker() {\n\t\tthis._toggle();\n\n\t\tif (!isPhone()) {\n\t\t\tthis._innerInput.focus();\n\t\t} else {\n\t\t\tthis.allItemsPopover.focus();\n\t\t}\n\t}\n\n\t_toggle() {\n\t\tthis.open = !this.open;\n\t\tthis.fireEvent(\"open-change\");\n\t}\n\n\t_getSelectedItems() {\n\t\t// Angular 2 way data binding\n\t\tthis.selectedValues = this.items.filter(item => item.selected);\n\t\treturn this.selectedValues;\n\t}\n\n\t_listSelectionChange(event) {\n\t\t// sync list items and cb items\n\t\tthis.syncItems(event.target.items);\n\n\t\t// don't call selection change right after selection as user can cancel it on phone\n\t\tif (!isPhone()) {\n\t\t\tthis.fireSelectionChange();\n\t\t}\n\n\t\tif (!event.detail.selectionComponentPressed && !isSpace(event.detail)) {\n\t\t\tthis.allItemsPopover.close();\n\t\t\tthis.value = \"\";\n\n\t\t\t// if the item (not checkbox) is clicked, call the selection change\n\t\t\tif (isPhone()) {\n\t\t\t\tthis.fireSelectionChange();\n\t\t\t}\n\n\t\t\tthis.fireEvent(\"input\");\n\t\t}\n\t}\n\n\tsyncItems(listItems) {\n\t\tlistItems.forEach(item => {\n\t\t\tthis.items.forEach(mcbItem => {\n\t\t\t\tif (mcbItem._id === item.getAttribute(\"data-ui5-token-id\")) {\n\t\t\t\t\tmcbItem.selected = item.selected;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tfireSelectionChange() {\n\t\tthis.fireEvent(\"selection-change\", { items: this._getSelectedItems() });\n\t\t// Angular 2 way data binding\n\t\tthis.fireEvent(\"value-changed\");\n\t}\n\n\tasync _getRespPopover() {\n\t\tconst staticAreaItem = await this.getStaticAreaItemDomRef();\n\t\tthis.allItemsPopover = staticAreaItem.querySelector(`.ui5-multi-combobox-all-items-responsive-popover`);\n\t}\n\n\tasync _getList() {\n\t\tconst staticAreaItem = await this.getStaticAreaItemDomRef();\n\t\tthis.list = staticAreaItem.querySelector(\".ui5-multi-combobox-all-items-list\");\n\t}\n\n\t_click(event) {\n\t\tif (isPhone() && !this.readonly && !this._showMorePressed && !this._deleting) {\n\t\t\tthis.allItemsPopover.showAt(this);\n\t\t}\n\n\t\tthis._showMorePressed = false;\n\t}\n\n\t_afterClosePicker() {\n\t\t// close device's keyboard and prevent further typing\n\t\tif (isPhone()) {\n\t\t\tthis.blur();\n\t\t}\n\n\t\tthis._toggle();\n\n\t\tthis._iconPressed = false;\n\t\tthis.filterSelected = false;\n\t}\n\n\t_beforeOpen() {\n\t\tthis._itemsBeforeOpen = this.items.map(item => {\n\t\t\treturn {\n\t\t\t\tref: item,\n\t\t\t\tselected: item.selected,\n\t\t\t};\n\t\t});\n\n\t\tthis._valueBeforeOpen = this.value;\n\n\t\tif (this.filterSelected) {\n\t\t\tthis.selectedItems = this._filteredItems.filter(item => item.selected);\n\t\t}\n\t}\n\n\tonBeforeRendering() {\n\t\tconst input = this.shadowRoot.querySelector(\"input\");\n\t\tthis._inputLastValue = this.value;\n\n\t\tif (input && !input.value) {\n\t\t\tthis._filteredItems = this.items;\n\t\t}\n\n\t\tthis.items.forEach(item => {\n\t\t\titem._getRealDomRef = () => this.allItemsPopover.querySelector(`*[data-ui5-stable=${item.stableDomRef}]`);\n\t\t});\n\n\t\tconst filteredItems = this._filterItems(this.value);\n\t\tthis._filteredItems = filteredItems;\n\t}\n\n\tasync onAfterRendering() {\n\t\tawait this._getRespPopover();\n\t\tawait this._getList();\n\n\t\tthis.toggle(this.shouldDisplayOnlyValueStateMessage);\n\t\tthis.storeResponsivePopoverWidth();\n\n\t\tthis._deleting = false;\n\t}\n\n\tget _isPhone() {\n\t\treturn isPhone();\n\t}\n\n\t_onIconMousedown() {\n\t\tthis._iconPressed = true;\n\t}\n\n\tstoreResponsivePopoverWidth() {\n\t\tif (this.open && !this._listWidth) {\n\t\t\tthis._listWidth = this.list.offsetWidth;\n\t\t}\n\t}\n\n\ttoggle(isToggled) {\n\t\tif (isToggled && !this.open) {\n\t\t\tthis.openPopover();\n\t\t} else {\n\t\t\tthis.closePopover();\n\t\t}\n\t}\n\n\thandleCancel() {\n\t\tthis._itemsBeforeOpen.forEach(item => {\n\t\t\titem.ref.selected = item.selected;\n\t\t});\n\n\t\tthis.togglePopover();\n\n\t\tthis.value = this._valueBeforeOpen;\n\t}\n\n\thandleOK() {\n\t\tif (isPhone()) {\n\t\t\tthis.fireSelectionChange();\n\t\t}\n\n\t\tthis.togglePopover();\n\t}\n\n\tasync openPopover() {\n\t\tconst popover = await this._getPopover();\n\n\t\tif (popover) {\n\t\t\tpopover.showAt(this);\n\t\t}\n\t}\n\n\t_forwardFocusToInner() {\n\t\tthis._innerInput.focus();\n\t}\n\n\tasync closePopover() {\n\t\tconst popover = await this._getPopover();\n\n\t\tpopover && popover.close();\n\t}\n\n\tasync _getPopover() {\n\t\tconst staticAreaItem = await this.getStaticAreaItemDomRef();\n\t\treturn staticAreaItem.querySelector(\"[ui5-popover]\");\n\t}\n\n\tasync _getResponsivePopover() {\n\t\tconst staticAreaItem = await this.getStaticAreaItemDomRef();\n\t\treturn staticAreaItem.querySelector(\"[ui5-responsive-popover]\");\n\t}\n\n\tasync _setValueStateHeader() {\n\t\tconst responsivePopover = await this._getResponsivePopover();\n\t\tthis.valueStateHeader = responsivePopover.querySelector(\"div.ui5-responsive-popover-header.ui5-valuestatemessage-root\");\n\t}\n\n\tget _tokenizer() {\n\t\treturn this.shadowRoot.querySelector(\"[ui5-tokenizer]\");\n\t}\n\n\tinputFocusIn() {\n\t\tif (!isPhone() || this.readonly) {\n\t\t\tthis.focused = true;\n\t\t} else {\n\t\t\tthis._innerInput.blur();\n\t\t}\n\n\t\tthis._lastValue = this.value;\n\t}\n\n\tinputFocusOut(event) {\n\t\tif (!this.shadowRoot.contains(event.relatedTarget) && !this._deleting) {\n\t\t\tthis.focused = false;\n\n\t\t\t// remove the value if user focus out the input and focus is not going in the popover\n\t\t\tif (!isPhone() && !this.allowCustomValues && (this.staticAreaItem !== event.relatedTarget)) {\n\t\t\t\tthis.value = \"\";\n\t\t\t}\n\t\t}\n\t}\n\n\t_readonlyIconClick() {\n\t\tthis._inputDom.focus();\n\t}\n\n\tget editable() {\n\t\treturn !this.readonly;\n\t}\n\n\tget _isFocusInside() {\n\t\treturn !isPhone() && (this.focused || this._tokenizerFocused);\n\t}\n\n\tget selectedItemsListMode() {\n\t\treturn this.readonly ? \"None\" : \"MultiSelect\";\n\t}\n\n\tget _listItemsType() {\n\t\treturn this.readonly ? \"Inactive\" : \"Active\";\n\t}\n\n\tget hasValueState() {\n\t\treturn this.valueState !== ValueState.None;\n\t}\n\n\tget hasValueStateMessage() {\n\t\treturn this.hasValueState && this.valueState !== ValueState.Success;\n\t}\n\n\tget valueStateText() {\n\t\tlet key = this.valueState;\n\n\t\tif (this._performingSelectionTwice) {\n\t\t\tkey = \"Error_Selection\";\n\t\t}\n\n\t\treturn this.valueStateTextMappings[key];\n\t}\n\n\tget valueStateTextId() {\n\t\treturn this.hasValueState ? `${this._id}-valueStateDesc` : undefined;\n\t}\n\n\tget valueStateMessageText() {\n\t\treturn this.getSlottedNodes(\"valueStateMessage\").map(el => el.cloneNode(true));\n\t}\n\n\t/**\n\t * This method is relevant for sap_horizon theme only\n\t */\n\t get _valueStateMessageIcon() {\n\t\tconst iconPerValueState = {\n\t\t\tError: \"error\",\n\t\t\tWarning: \"alert\",\n\t\t\tSuccess: \"sys-enter-2\",\n\t\t\tInformation: \"information\",\n\t\t};\n\n\t\treturn this.valueState !== ValueState.None ? iconPerValueState[this.valueState] : \"\";\n\t}\n\n\tget _tokensCountText() {\n\t\tif (!this._tokenizer) {\n\t\t\treturn;\n\t\t}\n\t\treturn this._tokenizer._tokensCountText();\n\t}\n\n\tget _tokensCountTextId() {\n\t\treturn `${this._id}-hiddenText-nMore`;\n\t}\n\n\tget ariaDescribedByText() {\n\t\treturn this.valueStateTextId ? `${this._tokensCountTextId} ${this.valueStateTextId}` : `${this._tokensCountTextId}`;\n\t}\n\n\tget shouldDisplayDefaultValueStateMessage() {\n\t\treturn !this.valueStateMessage.length && this.hasValueStateMessage;\n\t}\n\n\tget shouldDisplayOnlyValueStateMessage() {\n\t\treturn this.focused && !this.readonly && this.hasValueStateMessage && !this._iconPressed;\n\t}\n\n\tget valueStateTextMappings() {\n\t\treturn {\n\t\t\t\"Success\": MultiComboBox.i18nBundle.getText(VALUE_STATE_SUCCESS),\n\t\t\t\"Error\": MultiComboBox.i18nBundle.getText(VALUE_STATE_ERROR),\n\t\t\t\"Error_Selection\": MultiComboBox.i18nBundle.getText(VALUE_STATE_ERROR_ALREADY_SELECTED),\n\t\t\t\"Warning\": MultiComboBox.i18nBundle.getText(VALUE_STATE_WARNING),\n\t\t\t\"Information\": MultiComboBox.i18nBundle.getText(VALUE_STATE_INFORMATION),\n\t\t};\n\t}\n\n\tget _innerInput() {\n\t\tif (isPhone()) {\n\t\t\tif (this.allItemsPopover.opened) {\n\t\t\t\treturn this.allItemsPopover.querySelector(\"input\");\n\t\t\t}\n\t\t}\n\n\t\treturn this.getDomRef().querySelector(\"#ui5-multi-combobox-input\");\n\t}\n\n\tget _headerTitleText() {\n\t\treturn MultiComboBox.i18nBundle.getText(INPUT_SUGGESTIONS_TITLE);\n\t}\n\n\tget _iconAccessibleNameText() {\n\t\treturn MultiComboBox.i18nBundle.getText(SELECT_OPTIONS);\n\t}\n\n\tget _dialogOkButton() {\n\t\treturn MultiComboBox.i18nBundle.getText(MULTICOMBOBOX_DIALOG_OK_BUTTON);\n\t}\n\n\tget _tokenizerExpanded() {\n\t\treturn (this._isFocusInside || this.open) && !this.readonly;\n\t}\n\n\tget _valueStatePopoverHorizontalAlign() {\n\t\treturn this.effectiveDir !== \"rtl\" ? \"Left\" : \"Right\";\n\t}\n\n\tget classes() {\n\t\treturn {\n\t\t\tpopover: {\n\t\t\t\t\"ui5-multi-combobox-all-items-responsive-popover\": true,\n\t\t\t\t\"ui5-suggestions-popover\": !this.isPhone,\n\t\t\t\t\"ui5-suggestions-popover-with-value-state-header\": !this.isPhone && this.hasValueStateMessage,\n\t\t\t},\n\t\t\tpopoverValueState: {\n\t\t\t\t\"ui5-valuestatemessage-root\": true,\n\t\t\t\t\"ui5-valuestatemessage-header\": true,\n\t\t\t\t\"ui5-valuestatemessage--success\": this.valueState === ValueState.Success,\n\t\t\t\t\"ui5-valuestatemessage--error\": this.valueState === ValueState.Error,\n\t\t\t\t\"ui5-valuestatemessage--warning\": this.valueState === ValueState.Warning,\n\t\t\t\t\"ui5-valuestatemessage--information\": this.valueState === ValueState.Information,\n\t\t\t},\n\t\t};\n\t}\n\n\tget styles() {\n\t\treturn {\n\t\t\tpopoverValueStateMessage: {\n\t\t\t\t\"width\": `${this._listWidth}px`,\n\t\t\t\t\"display\": this._listWidth === 0 ? \"none\" : \"inline-block\",\n\t\t\t},\n\t\t\tpopoverHeader: {\n\t\t\t\t\"max-width\": isPhone() ? \"100%\" : `${this._inputWidth}px`,\n\t\t\t},\n\t\t};\n\t}\n\n\tstatic async onDefine() {\n\t\tMultiComboBox.i18nBundle = await getI18nBundle(\"@ui5/webcomponents\");\n\t}\n}\n\nMultiComboBox.define();\n\nexport default MultiComboBox;\n"]},"metadata":{},"sourceType":"module"}