{"ast":null,"code":"import { getThemeProperties, getRegisteredPackages, isThemeRegistered } from \"../asset-registries/Themes.js\";\nimport { removeStyle, createOrUpdateStyle } from \"../ManagedStyles.js\";\nimport getThemeDesignerTheme from \"./getThemeDesignerTheme.js\";\nimport { fireThemeLoaded } from \"./ThemeLoaded.js\";\nimport { getFeature } from \"../FeaturesRegistry.js\";\nconst BASE_THEME_PACKAGE = \"@ui5/webcomponents-theming\";\n\nconst isThemeBaseRegistered = () => {\n  const registeredPackages = getRegisteredPackages();\n  return registeredPackages.has(BASE_THEME_PACKAGE);\n};\n\nconst loadThemeBase = async theme => {\n  if (!isThemeBaseRegistered()) {\n    return;\n  }\n\n  const cssData = await getThemeProperties(BASE_THEME_PACKAGE, theme);\n\n  if (cssData) {\n    createOrUpdateStyle(cssData, \"data-ui5-theme-properties\", BASE_THEME_PACKAGE);\n  }\n};\n\nconst deleteThemeBase = () => {\n  removeStyle(\"data-ui5-theme-properties\", BASE_THEME_PACKAGE);\n};\n\nconst loadComponentPackages = async theme => {\n  const registeredPackages = getRegisteredPackages();\n  registeredPackages.forEach(async packageName => {\n    if (packageName === BASE_THEME_PACKAGE) {\n      return;\n    }\n\n    const cssData = await getThemeProperties(packageName, theme);\n\n    if (cssData) {\n      createOrUpdateStyle(cssData, \"data-ui5-theme-properties\", packageName);\n    }\n  });\n};\n\nconst detectExternalTheme = () => {\n  // If theme designer theme is detected, use this\n  const extTheme = getThemeDesignerTheme();\n\n  if (extTheme) {\n    return extTheme;\n  } // If OpenUI5Support is enabled, try to find out if it loaded variables\n\n\n  const OpenUI5Support = getFeature(\"OpenUI5Support\");\n\n  if (OpenUI5Support) {\n    const varsLoaded = OpenUI5Support.cssVariablesLoaded();\n\n    if (varsLoaded) {\n      return {\n        themeName: OpenUI5Support.getConfigurationSettingsObject().theme // just themeName, baseThemeName is only relevant for custom themes\n\n      };\n    }\n  }\n};\n\nconst applyTheme = async theme => {\n  const extTheme = detectExternalTheme(); // Only load theme_base properties if there is no externally loaded theme, or there is, but it is not being loaded\n\n  if (!extTheme || theme !== extTheme.themeName) {\n    await loadThemeBase(theme);\n  } else {\n    deleteThemeBase();\n  } // Always load component packages properties. For non-registered themes, try with the base theme, if any\n\n\n  const packagesTheme = isThemeRegistered(theme) ? theme : extTheme && extTheme.baseThemeName;\n  await loadComponentPackages(packagesTheme);\n  fireThemeLoaded(theme);\n};\n\nexport default applyTheme;","map":{"version":3,"sources":["/Users/flo/Desktop/mdao.fioriapp/node_modules/@ui5/webcomponents-base/dist/theming/applyTheme.js"],"names":["getThemeProperties","getRegisteredPackages","isThemeRegistered","removeStyle","createOrUpdateStyle","getThemeDesignerTheme","fireThemeLoaded","getFeature","BASE_THEME_PACKAGE","isThemeBaseRegistered","registeredPackages","has","loadThemeBase","theme","cssData","deleteThemeBase","loadComponentPackages","forEach","packageName","detectExternalTheme","extTheme","OpenUI5Support","varsLoaded","cssVariablesLoaded","themeName","getConfigurationSettingsObject","applyTheme","packagesTheme","baseThemeName"],"mappings":"AAAA,SAASA,kBAAT,EAA6BC,qBAA7B,EAAoDC,iBAApD,QAA6E,+BAA7E;AACA,SAASC,WAAT,EAAsBC,mBAAtB,QAAiD,qBAAjD;AACA,OAAOC,qBAAP,MAAkC,4BAAlC;AACA,SAASC,eAAT,QAAgC,kBAAhC;AACA,SAASC,UAAT,QAA2B,wBAA3B;AAEA,MAAMC,kBAAkB,GAAG,4BAA3B;;AAEA,MAAMC,qBAAqB,GAAG,MAAM;AACnC,QAAMC,kBAAkB,GAAGT,qBAAqB,EAAhD;AACA,SAAOS,kBAAkB,CAACC,GAAnB,CAAuBH,kBAAvB,CAAP;AACA,CAHD;;AAKA,MAAMI,aAAa,GAAG,MAAMC,KAAN,IAAe;AACpC,MAAI,CAACJ,qBAAqB,EAA1B,EAA8B;AAC7B;AACA;;AAED,QAAMK,OAAO,GAAG,MAAMd,kBAAkB,CAACQ,kBAAD,EAAqBK,KAArB,CAAxC;;AACA,MAAIC,OAAJ,EAAa;AACZV,IAAAA,mBAAmB,CAACU,OAAD,EAAU,2BAAV,EAAuCN,kBAAvC,CAAnB;AACA;AACD,CATD;;AAWA,MAAMO,eAAe,GAAG,MAAM;AAC7BZ,EAAAA,WAAW,CAAC,2BAAD,EAA8BK,kBAA9B,CAAX;AACA,CAFD;;AAIA,MAAMQ,qBAAqB,GAAG,MAAMH,KAAN,IAAe;AAC5C,QAAMH,kBAAkB,GAAGT,qBAAqB,EAAhD;AACAS,EAAAA,kBAAkB,CAACO,OAAnB,CAA2B,MAAMC,WAAN,IAAqB;AAC/C,QAAIA,WAAW,KAAKV,kBAApB,EAAwC;AACvC;AACA;;AAED,UAAMM,OAAO,GAAG,MAAMd,kBAAkB,CAACkB,WAAD,EAAcL,KAAd,CAAxC;;AACA,QAAIC,OAAJ,EAAa;AACZV,MAAAA,mBAAmB,CAACU,OAAD,EAAU,2BAAV,EAAuCI,WAAvC,CAAnB;AACA;AACD,GATD;AAUA,CAZD;;AAcA,MAAMC,mBAAmB,GAAG,MAAM;AACjC;AACA,QAAMC,QAAQ,GAAGf,qBAAqB,EAAtC;;AACA,MAAIe,QAAJ,EAAc;AACb,WAAOA,QAAP;AACA,GALgC,CAOjC;;;AACA,QAAMC,cAAc,GAAGd,UAAU,CAAC,gBAAD,CAAjC;;AACA,MAAIc,cAAJ,EAAoB;AACnB,UAAMC,UAAU,GAAGD,cAAc,CAACE,kBAAf,EAAnB;;AACA,QAAID,UAAJ,EAAgB;AACf,aAAO;AACNE,QAAAA,SAAS,EAAEH,cAAc,CAACI,8BAAf,GAAgDZ,KADrD,CAC4D;;AAD5D,OAAP;AAGA;AACD;AACD,CAjBD;;AAmBA,MAAMa,UAAU,GAAG,MAAMb,KAAN,IAAe;AACjC,QAAMO,QAAQ,GAAGD,mBAAmB,EAApC,CADiC,CAGjC;;AACA,MAAI,CAACC,QAAD,IAAaP,KAAK,KAAKO,QAAQ,CAACI,SAApC,EAA+C;AAC9C,UAAMZ,aAAa,CAACC,KAAD,CAAnB;AACA,GAFD,MAEO;AACNE,IAAAA,eAAe;AACf,GARgC,CAUjC;;;AACA,QAAMY,aAAa,GAAGzB,iBAAiB,CAACW,KAAD,CAAjB,GAA2BA,KAA3B,GAAmCO,QAAQ,IAAIA,QAAQ,CAACQ,aAA9E;AACA,QAAMZ,qBAAqB,CAACW,aAAD,CAA3B;AAEArB,EAAAA,eAAe,CAACO,KAAD,CAAf;AACA,CAfD;;AAiBA,eAAea,UAAf","sourcesContent":["import { getThemeProperties, getRegisteredPackages, isThemeRegistered } from \"../asset-registries/Themes.js\";\nimport { removeStyle, createOrUpdateStyle } from \"../ManagedStyles.js\";\nimport getThemeDesignerTheme from \"./getThemeDesignerTheme.js\";\nimport { fireThemeLoaded } from \"./ThemeLoaded.js\";\nimport { getFeature } from \"../FeaturesRegistry.js\";\n\nconst BASE_THEME_PACKAGE = \"@ui5/webcomponents-theming\";\n\nconst isThemeBaseRegistered = () => {\n\tconst registeredPackages = getRegisteredPackages();\n\treturn registeredPackages.has(BASE_THEME_PACKAGE);\n};\n\nconst loadThemeBase = async theme => {\n\tif (!isThemeBaseRegistered()) {\n\t\treturn;\n\t}\n\n\tconst cssData = await getThemeProperties(BASE_THEME_PACKAGE, theme);\n\tif (cssData) {\n\t\tcreateOrUpdateStyle(cssData, \"data-ui5-theme-properties\", BASE_THEME_PACKAGE);\n\t}\n};\n\nconst deleteThemeBase = () => {\n\tremoveStyle(\"data-ui5-theme-properties\", BASE_THEME_PACKAGE);\n};\n\nconst loadComponentPackages = async theme => {\n\tconst registeredPackages = getRegisteredPackages();\n\tregisteredPackages.forEach(async packageName => {\n\t\tif (packageName === BASE_THEME_PACKAGE) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cssData = await getThemeProperties(packageName, theme);\n\t\tif (cssData) {\n\t\t\tcreateOrUpdateStyle(cssData, \"data-ui5-theme-properties\", packageName);\n\t\t}\n\t});\n};\n\nconst detectExternalTheme = () => {\n\t// If theme designer theme is detected, use this\n\tconst extTheme = getThemeDesignerTheme();\n\tif (extTheme) {\n\t\treturn extTheme;\n\t}\n\n\t// If OpenUI5Support is enabled, try to find out if it loaded variables\n\tconst OpenUI5Support = getFeature(\"OpenUI5Support\");\n\tif (OpenUI5Support) {\n\t\tconst varsLoaded = OpenUI5Support.cssVariablesLoaded();\n\t\tif (varsLoaded) {\n\t\t\treturn {\n\t\t\t\tthemeName: OpenUI5Support.getConfigurationSettingsObject().theme, // just themeName, baseThemeName is only relevant for custom themes\n\t\t\t};\n\t\t}\n\t}\n};\n\nconst applyTheme = async theme => {\n\tconst extTheme = detectExternalTheme();\n\n\t// Only load theme_base properties if there is no externally loaded theme, or there is, but it is not being loaded\n\tif (!extTheme || theme !== extTheme.themeName) {\n\t\tawait loadThemeBase(theme);\n\t} else {\n\t\tdeleteThemeBase();\n\t}\n\n\t// Always load component packages properties. For non-registered themes, try with the base theme, if any\n\tconst packagesTheme = isThemeRegistered(theme) ? theme : extTheme && extTheme.baseThemeName;\n\tawait loadComponentPackages(packagesTheme);\n\n\tfireThemeLoaded(theme);\n};\n\nexport default applyTheme;\n"]},"metadata":{},"sourceType":"module"}